var Ajax=function(){function n(n,t){n===void 0&&(n=!1);t===void 0&&(t=null);this.DisableElement=null;this.WithProgress=!1;this.UseAsDateUTC=!1;this.ContentType="application/json; charset=utf-8";this.eventHandlers=[];this.WithProgress=n;this.DisableElement=t}return Object.defineProperty(n.prototype,"ResponseText",{get:function(){return this.XHttp.responseText},enumerable:!0,configurable:!0}),n.prototype.Submit=function(n,t,i){var r,u;i===void 0&&(i=null);r=this;r.Progress();t=r.getUrl(t);r.XHttp=new XMLHttpRequest;u=r.XHttp;u.addEventListener("readystatechange",r.xStateChanged.bind(r),!1);u.open(n,t,!0);u.setRequestHeader("content-type",r.ContentType);r.setHead();try{u.send(r.getParameters(i))}catch(f){r.Progress(!1);window.Exception(f)}},n.prototype.xStateChanged=function(){var n=this,t=n.XHttp;n.isRequestReady()&&(n.Progress(!1),n.Dispatch(t.status===200||t.status===204?EventType.Completed:EventType.Error))},n.prototype.getUrl=function(t){var i=t,r=n.Host;return i.indexOf("http")!=-1||Is.NullOrEmpty(r)||(i=r+(i.indexOf("/")==0?i:"/"+i)),i},n.prototype.isRequestReady=function(){var n=this.XHttp;return n&&n.readyState==4},n.prototype.Progress=function(n){var r,i;if(n===void 0&&(n=!0),this.WithProgress){r=ProgressManager;n?r.Show():r.Hide();var t=this.DisableElement,u="disabled",f=function(t){n?t.setAttribute(u,u):t.removeAttribute(u)};if(t)if(Is.Array(t))for(i=0;i<t.length;i++)f(t[i]);else f(t)}},n.prototype.setHead=function(){var t=this,n,i;if(t.Header&&(n=t.Header(),n))for(i in n)t.XHttp.setRequestHeader(i,n[i])},n.prototype.getParameters=function(n){var t="";return n&&this.ContentType==="application/json; charset=utf-8"&&(t=JSON.stringify(n).replace(/\\\"__type\\\"\:\\\"[\w+\.?]+\\\"\,/g,"").replace(/\"__type\"\:\"[\w+\.?]+\"\,/g,"").replace(/<script/ig,"").replace(/script>/ig,"")),t},n.prototype.GetRequestData=function(){var n=null,i=this,t=this.XHttp;if(i.isRequestReady()&&(t.status==200||t.status==204)&&!Is.NullOrEmpty(t.responseText)){n=t.responseText;try{n=JSON.parse(n);n.d&&(n=n.d);i.convertProperties(n)}catch(r){n=null;window.Exception(r)}}return n},n.prototype.convertProperties=function(n){var t,i=this,u,r,f;if(Is.Array(n))for(u=0;u<n.length;u++){if(r=n[u],r){try{t=t?t:i.getKeyMap(r)}catch(e){window.Exception(e)}i.setValues(r,t)}for(f in r)i.convertProperties(r[f])}else if(n&&typeof n=="object"){t=i.getKeyMap(n);i.setValues(n,t);for(f in n)i.convertProperties(n[f])}},n.prototype.getKeyMap=function(n){var r=[],i,t;for(i in n)t=n[i],t&&typeof t=="string"&&(t=t.Trim(),t.indexOf("/Date(")==0||t.indexOf("Date(")==0?r.push({Key:i,Type:"Date"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/i)?r.push({Key:i,Type:"UTCDate"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/g)&&r.push({Key:i,Type:"ZDate"}));return r},n.prototype.setValues=function(n,t){for(var r,e,u=0;u<t.length;u++){var f=t[u].Key,o=t[u].Type,i=n[f];switch(o){case"Date":i?(i=parseInt(i.substring(6).replace(")/","")),i>-621355752e5?(i=new Date(i),n[f]=i):delete n[f]):n[f]=new Date;break;case"UTCDate":case"ZDate":r=new Date(i);this.UseAsDateUTC?r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()):window.chrome&&(e=(new Date).getTimezoneOffset(),r=r.Add(0,0,0,0,e));n[f]=r}}},n.prototype.Get=function(n,t){t===void 0&&(t=null);this.Submit("GET",n,t)},n.prototype.Put=function(n,t){t===void 0&&(t=null);this.Submit("PUT",n,t)},n.prototype.Post=function(n,t){t===void 0&&(t=null);this.Submit("POST",n,t)},n.prototype.Delete=function(n,t){t===void 0&&(t=null);this.Submit("DELETE",n,t)},n.prototype.AddListener=function(n,t){this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eventHandlers.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n||t.EventType===EventType.Any});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),Binder=function(){function n(n,t,i,r){n===void 0&&(n=null);t===void 0&&(t=null);i===void 0&&(i=null);r===void 0&&(r=null);this._api=null;this.PrimaryKeys=[];this.WithProgress=!0;this.eventHandlers=[];this.DataObjects=[];this.AutomaticUpdate=!0;this.AutomaticSelect=!0;this.DataRowTemplates=[];this.IsFormBinding=!1;var u=n;this.StaticProperties=i;this.PrimaryKeys=u?u:this.PrimaryKeys;r&&(this.NewObject=function(n){return new r(n)});this._api=t}return n.prototype.ApiPrefix=function(){return"/Api/"},n.prototype.Api=function(){if(!this._api){var t=Reflection,n=t.GetName(this.constructor);n=n.replace("Binder","");this._api=this.ApiPrefix()+n}return this._api},n.prototype.WebApiGetParameters=function(n){var t=n,r=this.Api(),i;return r&&(i=r.split("/"),t!=null&&t.length>0&&t[0]==i[i.length-1]&&(t=t.slice(1),t.length==0))?null:t},n.prototype.NewObject=function(n){return new DynamicDataObject(n,this.StaticProperties)},n.prototype.Dispose=function(){var n=this,t=n.DataObject;n.PrimaryKeys=null;n.Api=null;t&&(t.RemoveObjectStateListener(),t.RemovePropertyListeners());n.DataObjects.forEach(function(n){n.RemoveObjectStateListener();n.RemovePropertyListeners()});n.RemoveListeners()},n.prototype.Execute=function(n){var t;if(n===void 0&&(n=null),t=this,t.AutomaticSelect&&!Is.NullOrEmpty(t.Api)){var r=t.WebApiGetParameters(n.Parameters),u=new Ajax(t.WithProgress,t.DisableElement),i=t.Api();u.AddListener(EventType.Completed,t.OnAjaxComplete.bind(this));r&&(i+=i.lastIndexOf("/")+1==i.length?"":"/",i+=Is.Array(r)?r.join("/"):r);u.Get(i)}else t.Dispatch(EventType.Completed)},n.prototype.OnAjaxComplete=function(n){var t=this,i,r,u;n.EventType===EventType.Completed&&(i=n.Sender.GetRequestData(),i&&(Is.Array(i)?(i.forEach(function(n){return t.Add(t.NewObject(n))}),r=t.MoreElement,u="none",r&&(u=t.DataObjects.length%50==0?"inline":"none",r?r.style.display=u:null)):i&&(t.IsFormBinding=!0,t.Bind(t.NewObject(i))),t.Dispatch(EventType.Completed)))},n.prototype.Delete=function(n,t){var i,r,u;if(t===void 0&&(t=null),i=n.DataObject,r=this,!i)for(u=n.parentElement;!i||u!==r.Element;)i=u.DataObject,u=u.parentElement;if(i){var f=new Ajax(r.WithProgress,r.DisableElement),e=function(){var n=r.Element.Get(function(n){return n.DataObject===i});n.forEach(function(n){return n.parentElement.removeChild(n)})},o=function(n){var i=function(){if(n.EventType===EventType.Error)throw"Failed to delete row.";};t?t(n):i();n.EventType===EventType.Completed?e():null},s=function(){f.AddListener(EventType.Any,o);f.Delete(r.Api(),i)};r.AutomaticUpdate?s():e()}},n.prototype.Add=function(n){var t=this;t.prepTemplates();t.DataRowTemplates.forEach(function(i){var r=i.CreateElementFromHtml(),u=r.Get(function(n){return n.HasDataSet()}),f=t.DataRowFooter;u.Add(r);f?t.Element.insertBefore(r,f):t.Element.appendChild(r);t.DataObjects.Add(n);n.Container=t.DataObjects;t.Bind(n,u)})},n.prototype.prepTemplates=function(){var n=this,i;if(n.DataRowTemplates.length==0){var t=n.Element.children,r=[],o=0;for(i=0;i<t.length;i++)t[i].getAttribute("data-template")!=null&&(r.Add(t[i]),o=i);t[t.length-1]!=r[r.length-1]&&(n.DataRowFooter=t[t.length-1]);r.forEach(function(t){n.DataRowTemplates.Add(t.outerHTML);t.parentElement.removeChild(t)});var f="data-morekeys",e="data-morethreshold",u=n.Element.First(function(n){return n.HasDataSet()&&n.getAttribute(f)!=null&&n.getAttribute(e)!=null});u&&(n.MoreElement=u,n.MoreKeys=u.getAttribute(f).split(";"),n.MoreThreshold=parseInt(u.getAttribute(e)),n.MoreElement.onclick=function(){n.More()})}},n.prototype.objStateChanged=function(n){var t=this,i;t.AutomaticUpdate&&t.Api&&(i=new Ajax(t.WithProgress,t.DisableElement),i.AddListener(EventType.Completed,t.OnUpdateComplete.bind(this)),i.Put(t.Api(),n.ServerObject),n.ObjectState=ObjectState.Clean)},n.prototype.OnUpdateComplete=function(n){var t=this,i=n.Sender.GetRequestData(),r=t.DataObject?t.DataObject:t.DataObjects.First(function(n){return t.isPKMatch(n,i)});r?t.SetServerObjectValue(r,i):null},n.prototype.SetServerObjectValue=function(n,t){for(var i in t)this.PrimaryKeys.First(function(n){return n===i})||n.SetServerProperty(i,t[i])},n.prototype.isPKMatch=function(n,t){for(var r=this,i=0;i<r.PrimaryKeys.length;i++)if(n.ServerObject[r.PrimaryKeys[i]]!=t[r.PrimaryKeys[i]])return!1;return!0},n.prototype.Bind=function(n,t){t===void 0&&(t=null);var i=this;t||(t=i.Element.Get(function(n){return n.HasDataSet()}),t.Add(i.Element));i.IsFormBinding&&(i.DataObject=n);n.AddObjectStateListener(i.objStateChanged.bind(this));t.forEach(function(t){t.DataObject=n;i.setListeners(t,n)});n.AllPropertiesChanged()},n.prototype.setListeners=function(n,t){var i=n.GetDataSetAttributes(),r=this,o,s,h;if(n.tagName==="SELECT"){var u=i.First(function(n){return n.Attribute=="datasource"}),f=i.First(function(n){return n.Attribute=="displaymember"}),e=i.First(function(n){return n.Attribute=="valuemember"});u&&(o=new Function("return "+u.Property),s=o(),n.AddOptions(s,e?e.Property:null,f?f.Property:null))}h=["binder","datasource","displaymember","valuemember"];i.forEach(function(i){var f,u,e;h.First(function(n){return n===i.Attribute})||(f=r.getAttribute(i.Attribute),r.setObjPropListener(i.Property,f,n,t),u=i.Attribute==="checked"&&n.type==="checkbox"?"checked":i.Attribute==="value"?"value":null,u&&(e=function(){t.OnElementChanged.bind(t)(n[u],i.Property)},n.addEventListener("change",e)))})},n.prototype.getAttribute=function(n){n=n.toLowerCase();switch(n){case"class":case"classname":return"className";case"innerhtml":return"innerHTML";case"readonly":return"readOnly";default:return n}},n.prototype.setObjPropListener=function(n,t,i,r){var u=this,f=function(n,t){var r,f,e;Has.Properties(i,n)?i.tagName==="INPUT"&&i.type==="radio"?(r=i.parentElement.Get(function(n){return n.name===i.name&&n.type==="radio"}),r.forEach(function(n){return n.checked=!1}),f=r.First(function(n){return n.value===t.toString()}),f?f.checked=!0:null):n==="className"?(i.className=null,i.className=t):i[n]=t:(e=u.getStyle(n),e?i.style[e]=t:i[n]=t)};r.AddPropertyListener(n,t,f)},n.prototype.getStyle=function(n){for(var t in document.body.style)if(t.toLowerCase()===n.toLowerCase())return t;return null},Object.defineProperty(n.prototype,"SelectedObject",{get:function(){return this.selectedObject},set:function(n){this.selectedObject=n},enumerable:!0,configurable:!0}),n.prototype.AddListener=function(n,t){var i=this.eventHandlers.First(function(i){return i.EventType===n&&i.EventHandler===t});i||this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){n===void 0&&(n=EventType.Any);this.eventHandlers.Remove(function(t){return n===EventType.Any||t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n.prototype.More=function(){var f=this.Element.Binder,e=HistoryManager.CurrentViewInstance(),n=f.DataObjects,t,i;if(n&&n.length>0){var r=new ViewInstance([],e.ViewContainer),o=n[n.length-1],u=e.Parameters;if(u!=null)for(t=0;t<u.length;t++)(i=u[t],i!=0||this._api.indexOf(i)!=0)&&r.Parameters.Add(i);this.MoreKeys.forEach(function(n){r.Parameters.Add(o[n])});f.Execute(r)}},n}(),__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},DataObject=function(){function n(n,t){t===void 0&&(t=null);this.AlternateOnEvens=!0;this.changeCount=0;this.changeQueued=!1;this.eLstenrs=[];this.oLstenrs=[];this.objectState=ObjectState.Clean;var i=n;this.serverObject=i;t?t.forEach(function(n){Has.Properties(i,n)||(i[n]=null)}):null;this.objectState=ObjectState.Clean}return Object.defineProperty(n.prototype,"AlternatingClass",{get:function(){if(this.alternatingClass!=null){var n=this.Container.indexOf(this)+1,t=n%2==0;return t==this.AlternateOnEvens?this.alternatingClass:null}return null},set:function(n){this.alternatingClass=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ObjectState",{get:function(){return this.objectState},set:function(n){var t=this;t.objectState=n;n===ObjectState.Dirty&&t.OnObjectStateChanged()},enumerable:!0,configurable:!0}),n.prototype.AddPropertyListener=function(n,t,i){this.eLstenrs.Add(new PropertyListener(n,t,i))},n.prototype.RemovePropertyListeners=function(){this.eLstenrs.Remove(function(){return!0})},n.prototype.OnPropertyChanged=function(n){var t=this,i=this.eLstenrs.Where(function(t){return t.PropertyName===n});i.forEach(function(i){return i.Handler(i.Attribute,t[n])})},n.prototype.AllPropertiesChanged=function(){var n=this;this.eLstenrs.forEach(function(t){return t.Handler(t.Attribute,n[t.PropertyName])})},n.prototype.InstigatePropertyChangedListeners=function(n,t){t===void 0&&(t=!0);this.OnPropertyChanged(n);t&&this.ObjectState!=ObjectState.Cleaning&&(this.ObjectState=ObjectState.Dirty)},n.prototype.AddObjectStateListener=function(n){this.oLstenrs.Add(n)},n.prototype.RemoveObjectStateListener=function(){this.oLstenrs.Remove(function(){return!0})},n.prototype.OnObjectStateChanged=function(){var n=this;this.oLstenrs.forEach(function(t){return t(n)})},n.prototype.OnElementChanged=function(n,t){this[t]=n},Object.defineProperty(n.prototype,"ServerObject",{get:function(){return this.serverObject},set:function(n){this.serverObject=n},enumerable:!0,configurable:!0}),n.prototype.SetServerProperty=function(n,t){var i=this,r=t!=i.ServerObject[n];i.ServerObject[n]=t;r&&this.InstigatePropertyChangedListeners(n,!0)},n}(),DynamicDataObject=function(n){function t(t,i){var r,u;i===void 0&&(i=null);r=t;n.call(this,r,i);for(u in r)this.setProps(u,r)}return __extends(t,n),t.prototype.setProps=function(n,t){var i=this,u=function(){return t[n]},f=function(t){i.SetServerProperty(n,t)},r=Object.defineProperty;r?r(i,n,{get:u,set:f}):null},t}(DataObject),CacheStrategy,HistoryContainer,HistoryManager,Is,Has,ProgressManager,Initializer,Reflection;(function(n){n[n.None=0]="None";n[n.ViewAndPreload=1]="ViewAndPreload";n[n.View=2]="View";n[n.Preload=3]="Preload"})(CacheStrategy||(CacheStrategy={}));var View=function(){function n(n,t,i){n===void 0&&(n=CacheStrategy.View);t===void 0&&(t="content");i===void 0&&(i=null);this.CacheStrategy=CacheStrategy.None;this._containerID=null;this.eHandlrs=[];this.binders=[];this.preload=null;this.url=i;this._containerID=t;this.CacheStrategy=n}return n.prototype.Prefix=function(){return"/Views/"},n.prototype.Url=function(){if(!this.url){var n=Reflection.GetName(this.constructor).replace("View","");this.url=this.Prefix()+n+".html"}return this.url},n.prototype.ContainerID=function(){return this._containerID},Object.defineProperty(n.prototype,"Preload",{get:function(){return this.preload},set:function(n){this.preload=n},enumerable:!0,configurable:!0}),n.prototype.Cache=function(n){var t,r,i;n===void 0&&(n=CacheStrategy.ViewAndPreload);t=this;t.Preload&&(n===CacheStrategy.ViewAndPreload||n===CacheStrategy.Preload)&&t.Preload.Execute(function(){});r=sessionStorage.getItem(t.Url());r||n!==CacheStrategy.View&&n!==CacheStrategy.ViewAndPreload||(i=new Ajax,i.AddListener(EventType.Completed,function(n){t.RequestCompleted(n,!0)}),i.Get(t.Url()))},n.prototype.Show=function(n){var t=this;t.ViewInstance=n;t.binders=[];t.binders.forEach(function(n){return n.RemoveListeners(EventType.Any)});t.Preload?t.Preload.Execute(t.postPreloaded.bind(this)):t.postPreloaded()},n.prototype.postPreloaded=function(){var n=this,i=sessionStorage.getItem(n.Url()),t;!i||window.IsDebug?(t=new Ajax,t.AddListener(EventType.Completed,n.RequestCompleted.bind(this)),t.Get(n.Url())):n.SetHTML(i)},n.prototype.RequestCompleted=function(n,t){t===void 0&&(t=!1);n.Sender.ResponseText&&(sessionStorage.setItem(this.Url(),n.Sender.ResponseText),t||this.SetHTML(n.Sender.ResponseText));n.Sender=null},n.prototype.SetHTML=function(n){var r=this,t=this,u=t.ContainerID().Element(),i;Is.NullOrEmpty(u)?t.Dispatch(EventType.Completed):(t.cached="div".CreateElement({innerHTML:n}),i=t.cached.Get(function(n){return!Is.NullOrEmpty(n.getAttribute("data-binder"))}),t.countBindersReported=0,i.length>0?(i.forEach(function(n){var i,u;try{i=n.getAttribute("data-binder");i&&(u=new Function("return new "+i+(i.indexOf("Binder(")==0?"":"()")),n.Binder=u(),n.Binder.AddListener(EventType.Completed,t.OnBinderComplete.bind(r)),n.Binder.Element=n,t.binders.Add(n.Binder))}catch(n){window.Exception(n)}}),i.forEach(function(n){if(n.Binder)try{n.Binder.Execute(t.ViewInstance)}catch(i){window.Exception(n)}})):t.MoveStuffFromCacheToReal())},n.prototype.OnBinderComplete=function(n){var i=this,t=this;n.EventType===EventType.Completed&&(t.countBindersReported=t.countBindersReported+1,t.binders.length===t.countBindersReported&&(t.MoveStuffFromCacheToReal(),t.binders.forEach(function(n){n.RemoveListener(EventType.Completed,t.OnBinderComplete.bind(i))})))},n.prototype.MoveStuffFromCacheToReal=function(){var n=this,t=n.ContainerID().Element(),r=t.Get(function(n){return n.Binder!=null}),i;for(r.forEach(function(n){return n.Binder.Dispose()}),t.Clear();n.cached.childNodes.length>0;)i=n.cached.childNodes[0],n.cached.removeChild(i),t.appendChild(i);n.Dispatch(EventType.Completed)},n.prototype.AddListener=function(n,t){var i=this,r=i.eHandlrs.First(function(i){return i.EventType===n&&i.EventHandler===t});r||i.eHandlrs.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eHandlrs.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eHandlrs.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eHandlrs.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),DataLoaders=function(){function n(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this.completedCount=0;this._dataLoaders=t}return n.prototype.Execute=function(n){var i=this,t=this;t._callback=n;t.completedCount=0;t._dataLoaders.forEach(function(n){return n.Execute(t.Completed.bind(i))})},n.prototype.Completed=function(){var n=this;n.completedCount++;n.completedCount===n._dataLoaders.length&&n._callback()},n}(),DataLoader=function(){function n(n,t,i,r){i===void 0&&(i=null);r===void 0&&(r=null);this._parameters=null;var u=this;u._dataCallBack=t;u._dataUrl=n;u._shouldTryLoad=i}return n.prototype.Execute=function(n){var t=this,i;t._completed=n;!t._shouldTryLoad||t._shouldTryLoad()?(i=new Ajax,i.AddListener(EventType.Completed,t._ajaxCompleted.bind(this)),i.Get(t._dataUrl,t._parameters)):t._completed()},n.prototype._ajaxCompleted=function(n){this._dataCallBack(n);this._completed()},n}(),ViewContainers=[],ViewContainer=function(){function n(){this.Views=[];this.IsDefault=!1;var n=Reflection.GetName(this.constructor);this.UrlBase=n.replace("Container","");ViewContainers.push(this)}return n.prototype.Show=function(n){var t=this;this.NumberViewsShown=0;ProgressManager.Show();this.Views.forEach(function(i){i.AddListener(EventType.Completed,t.ViewLoadCompleted.bind(t));i.Show(n)})},n.prototype.IsUrlPatternMatch=function(n){var t=this.UrlPattern(),i;return t?(i=new RegExp(t,"i"),n.match(i)?!0:!1):!1},n.prototype.ViewLoadCompleted=function(n){n.EventType===EventType.Completed&&(this.NumberViewsShown=this.NumberViewsShown+1);this.NumberViewsShown===this.Views.length&&ProgressManager.Hide()},n.prototype.Url=function(n){var t=n.Parameters,i;return t?(i=t[0]==this.UrlBase?t.slice(1).join("/"):t.join("/"),this.UrlBase+(i.length>0?"/"+i:"")):this.UrlBase},n.prototype.DocumentTitle=function(){return this.UrlBase},n.prototype.UrlPattern=function(){return this.UrlBase},n.prototype.UrlTitle=function(){return this.UrlBase},n}(),ViewInstance=function(){function n(n,t){this.Parameters=n;this.ViewContainer=t}return n}(),EventType;(function(n){n[n.Any=0]="Any";n[n.Completed=1]="Completed";n[n.Error=2]="Error";n[n.Aborted=3]="Aborted";n[n.Message=4]="Message"})(EventType||(EventType={}));var CustomEventArg=function(){function n(n,t){this.Cancel=!1;this.Sender=n;this.EventType=t}return n}(),Listener=function(){function n(n,t){this.EventType=n;this.EventHandler=t}return n}(),PropertyListener=function(){function n(n,t,i){this.PropertyName=n;this.Attribute=t;this.Handler=i}return n}(),ObjectState;(function(n){n[n.Dirty=0]="Dirty";n[n.Cleaning=1]="Cleaning";n[n.Clean=2]="Clean"})(ObjectState||(ObjectState={})),function(n){var t=function(){function n(){this.ViewInstances=[]}return n.prototype.CurrentViewInstance=function(){var n=this.ViewInstances;return n!=null&&n.length>0?n[n.length-1]:null},n.prototype.BackEvent=function(){HistoryManager.Back()},n.prototype.Add=function(n){this.ViewInstances.Add(n);this.ManageRouteInfo(n)},n.prototype.Back=function(){var n=this.ViewInstances,t,i;n.length>1&&n.splice(n.length-1,1);n.length>0&&(t=n[n.length-1],i=t.ViewContainer,i.Show(t),this.ManageRouteInfo(t))},n.prototype.ManageRouteInfo=function(n){var i=n,r=i.ViewContainer,f=r.UrlTitle(i),e=r.DocumentTitle(i),u=history,t=r.Url(i);t&&!Is.NullOrEmpty(f)&&u&&u.pushState&&(t=this.FormatUrl(Is.NullOrEmpty(t)?"/":t.indexOf("/")!=0?"/"+t:t),u.pushState(null,f,t));e&&(document.title=e)},n.prototype.FormatUrl=function(n){return n.replace(/[^A-z0-9/]/g,"")},n}();n.History=t}(HistoryContainer||(HistoryContainer={}));HistoryManager=new HistoryContainer.History,function(n){function t(n){return Object.prototype.toString.call(n)==="[object Array]"}function i(n){return n==null||n.length&&n.length===0}n.Array=t;n.NullOrEmpty=i}(Is||(Is={})),function(n){function t(n){for(var r,i,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];for(r=u,i=0;i<r.length;i++)if(n[r[i]]===undefined)return!1;return!0}n.Properties=t}(Has||(Has={})),function(n){function t(){var t=n.ProgressElement;t&&(t.style.display="inline")}function i(){var t=n.ProgressElement;t&&(t.style.display="none")}n.ProgressElement=null;n.Show=t;n.Hide=i}(ProgressManager||(ProgressManager={}));Array.prototype.Add=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];for(n=r,Is.Array(n)||(n=[n]),i=0;i<n.length;i++)this.push(n[i])};Array.prototype.First=function(n){var i=this,r=i.length,t;if(n){for(t=0;t<r;t++)if(n(i[t]))return i[t]}else if(r>0)return i[0];return null};Array.prototype.Last=function(n){var i=this,r=i.length,t;if(n)for(t=r-1;t>0;){if(n(i[t]))return i[t];t--}return r>0?i[r-1]:null};Array.prototype.Remove=function(n){var i=this,t;if(n)for(t=i.length-1;t>0;)n(i[t])&&i.splice(t,1),t--;return i};Array.prototype.Where=function(n){for(var i,r=[],t=0;t<this.length;t++)i=this[t],n(i)&&r.push(i);return r};Date.prototype.Add=function(n,t,i,r,u,f){n=n?n:0;t=t?t:0;i=i?i:0;r=r?r:0;u=u?u:0;f=f?f:0;var e=this;return new Date(e.getFullYear()+n,e.getMonth()+t,e.getDate()+i,e.getHours()+r,e.getMinutes()+u,e.getSeconds()+f,e.getMilliseconds())};Date.prototype.ToyyyymmddHHMMss=function(){var n=function(n){return(n<=9?"0":"")+n.toString()},t=n(this.getDate()),i=n(this.getMonth()+1),r=this.getFullYear(),u=n(this.getHours()),f=n(this.getMinutes()),e=n(this.getSeconds());return""+r+"-"+i+"-"+t+" "+u+":"+f+":"+e};HTMLElement.prototype.Get=function(n,t,i){for(var r,u=i==null?[]:i,e=this.children,f=0;f<e.length;f++)r=e[f],r.nodeType==1&&r.tagName.toLowerCase()!="svg"&&(n(r)&&u.push(r),!t&&r.Get&&r.Get(n,t,u));return u};HTMLElement.prototype.First=function(n){for(var t,u,r=this.children,i=0;i<r.length;i++)if(t=r[i],t.nodeType==1&&t.tagName.toLowerCase()!="svg"&&n(t))return t;for(i=0;i<r.length;i++)if(t=r[i],t.nodeType==1&&t.tagName.toLowerCase()!="svg"&&t.First&&(u=t.First(n),u))return u;return null};HTMLElement.prototype.Clear=function(){for(var n=this,t=n.childNodes;t.length>0;)n.removeChild(t[0])};HTMLElement.prototype.AddListener=function(n,t){this.addEventListener?this.addEventListener(n,t):this.attachEvent(n,t)};HTMLElement.prototype.Set=function(n){var r=this,i=n,t;if(i)for(t in i)t!="cls"&&t!="className"?t.IsStyle()?r.style[t]=i[t]:t==="style"?i.style.cssText&&(r.style.cssText=i.style.cssText):r[t]=i[t]:(r.className=null,r.className=i[t]);return r};HTMLElement.prototype.HasDataSet=function(){var n=this.dataset,t;if(n)for(t in n)return!0;return!1};HTMLElement.prototype.GetDataSetAttributes=function(){var i=[],n=this.dataset,t;if(n)for(t in n)i.Add({Attribute:t,Property:n[t]});return i};HTMLElement.prototype.DeleteFromServer=function(){for(var n=this.parentElement;!n.Binder;)if(n=n.parentElement,n===document.body)break;n&&n.Binder&&n.Binder.Delete(this)};HTMLElement.prototype.Ancestor=function(n){for(var t=this.parentElement;!n(t);)t=t.parentElement;return t};HTMLSelectElement.prototype.AddOptions=function(n,t,i,r){var o=this,h=r,u=n,s=function(n,t){var i=new Option(n,t);o.options[o.options.length]=i;h&&t===h&&(i.selected=!0)},f;if(Is.Array(u)){var e=u,c=i,l=t;c&&l?e.forEach(function(n){s(n[c],n[l])}):e.length>1&&typeof e[0]=="string"&&e.forEach(function(n){s(n,n)})}else if(u)for(f in u)u[f]&&{}.toString.call(u[f])==="[object Function]"||s(u[f],u[f]);return o};String.prototype.Trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.Element=function(){return document.getElementById(this.toString())};String.prototype.CreateElement=function(n){var t=document.createElement(this),i=n;return i&&t.Set(i),t};String.prototype.CreateElementFromHtml=function(){for(var t="div".CreateElement({innerHTML:this}),n=t.children;n.length>0;)return n[n.length-1]};String.prototype.IsStyle=function(){for(var n in document.body.style)if(n.toLowerCase()===this.toLowerCase())return!0;return!1};Window.prototype.Exception=function(){for(var r,t,n=[],i=0;i<arguments.length;i++)n[+i]=arguments[i];if(n.length==1){for(r={},t=0;t<n.length;t++)r["parameter"+t]=n[t];alert(JSON.stringify(r))}else n.length>1?alert(JSON.stringify(n[0])):alert("Unknown error")};Window.prototype.Show=function(n,t){var i=Reflection.NewObject(n),r=new ViewInstance(t,i);i.Show(r);HistoryManager.Add(r)};Window.prototype.ShowByUrl=function(n){var t=ViewContainers.First(function(t){return t.IsUrlPatternMatch(n)}),r,i;t=t==null?ViewContainers.First(function(n){return n.IsDefault}):t;t&&(r=n.split("/"),i=new ViewInstance(r,t),t.Show(i),HistoryManager.Add(i))},function(n){function i(i){var r=window;document.readyState==="complete"?(t(),n.WindowLoaded?n.WindowLoaded(i):null):r.onload=function(){t();n.WindowLoaded?n.WindowLoaded(i):null}}function t(){var n=window;r();n.ShowByUrl(n.location.pathname.substring(1));n.addEventListener("popstate",HistoryManager.BackEvent)}function r(){var n=document.getElementById("progress");n!=null&&(ProgressManager.ProgressElement=n)}n.Execute=i}(Initializer||(Initializer={})),function(n){function t(n,t){var r,u,i;return(t===void 0&&(t=[]),r=n&&n.toString?n.toString():null,!Is.NullOrEmpty(r)&&(u="^function\\s(\\w+)\\(\\)",i=r.match(u),i&&!t.First(function(n){return n===i[1]})))?i[1]:null}function i(n){return new n}n.GetName=t;n.NewObject=i}(Reflection||(Reflection={}));Initializer.Execute();