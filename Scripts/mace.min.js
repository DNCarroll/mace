var Ajax=function(){function n(){this.DisableElement=null;this.ManipulateProgressElement=!1;this.UseAsDateUTC=!0;this.ContentType="application/json; charset=utf-8";this.eventHandlers=[]}return Object.defineProperty(n.prototype,"ResponseText",{get:function(){return this.XMLHttpRequest.responseText},enumerable:!0,configurable:!0}),n.prototype.Submit=function(n,t,i){var r,u;i===void 0&&(i=null);r=this;r.showProgress();t=r.getUrl(t);r.XMLHttpRequest=new XMLHttpRequest;u=r.XMLHttpRequest;u.addEventListener("readystatechange",r.onReaderStateChange.bind(r),!1);u.open(n,t,!0);u.setRequestHeader("content-type",r.ContentType);r.setCustomHeader();try{u.send(r.getParameters(i))}catch(f){r.HideProgress();window.Exception(f)}},n.prototype.onReaderStateChange=function(){this.isRequestReady()&&(this.HideProgress(),this.Dispatch(EventType.Completed))},n.prototype.showProgress=function(){this.showHideProgress(!0)},n.prototype.getUrl=function(t){return t.indexOf("http")!=-1||Is.NullOrEmpty(n.Host)||(t=n.Host+(t.indexOf("/")==0?t:"/"+t)),t},n.prototype.isRequestReady=function(){return this.XMLHttpRequest&&this.XMLHttpRequest.readyState==4},n.prototype.HideProgress=function(){this.showHideProgress(!1)},n.prototype.showHideProgress=function(n){var t,i,r;if(this.ManipulateProgressElement&&(n?ProgressManager.Show():ProgressManager.Hide(),t=this.DisableElement,i="disabled",t))if(Is.Array(t))for(r=0;r<t.length;r++)n?t[r].setAttribute(i,i):t[r].removeAttribute(i);else n?t.setAttribute(i,i):t.removeAttribute(i)},n.prototype.setCustomHeader=function(){var t=this,n,i;if(t.Header&&(n=t.Header(),n))for(i in n)t.XMLHttpRequest.setRequestHeader(i,n[i])},n.prototype.getParameters=function(n){var t="";return n&&this.ContentType=="application/json; charset=utf-8"&&(t=JSON.stringify(n),t=t.replace(/\\\"__type\\\"\:\\\"[\w+\.?]+\\\"\,/g,""),t=t.replace(/\"__type\"\:\"[\w+\.?]+\"\,/g,""),t=t.replace(/<script/ig,""),t=t.replace(/script>/ig,"")),t},n.prototype.GetRequestData=function(){var n=null,t=this;if(t.isRequestReady()&&(t.XMLHttpRequest.status==200||t.XMLHttpRequest.status==204)&&!Is.NullOrEmpty(t.XMLHttpRequest.responseText)){n=t.XMLHttpRequest.responseText;try{n=JSON.parse(n);n.d&&(n=n.d);t.convertProperties(n)}catch(i){n=null;window.Exception(i)}}return n},n.prototype.convertProperties=function(n){var t,i=this,u,r,f;if(Is.Array(n))for(u=0;u<n.length;u++){if(r=n[u],r){try{t=t?t:i.getKeyMap(r)}catch(e){window.Exception(e)}i.setValues(r,t)}for(f in r)i.convertProperties(r[f])}else if(n&&typeof n=="object"){t=i.getKeyMap(n);i.setValues(n,t);for(f in n)i.convertProperties(n[f])}},n.prototype.getKeyMap=function(n){var r=[],i,t;for(i in n)t=n[i],t&&typeof t=="string"&&(t=t.Trim(),t.indexOf("/Date(")==0||t.indexOf("Date(")==0?r.push({Key:i,Type:"Date"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/i)?r.push({Key:i,Type:"UTCDate"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/g)&&r.push({Key:i,Type:"ZDate"}));return r},n.prototype.setValues=function(n,t){for(var r,e,u=0;u<t.length;u++){var f=t[u].Key,o=t[u].Type,i=n[f];switch(o){case"Date":i?(i=parseInt(i.substring(6).replace(")/","")),i>-621355752e5?(i=new Date(i),n[f]=i):delete n[f]):n[f]=new Date;break;case"UTCDate":case"ZDate":r=new Date(i);this.UseAsDateUTC?r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()):window.chrome&&(e=(new Date).getTimezoneOffset(),r=r.Add(0,0,0,0,e));n[f]=r}}},n.prototype.Get=function(n,t){t===void 0&&(t=null);this.Submit("GET",n,t)},n.prototype.Put=function(n,t){t===void 0&&(t=null);this.Submit("PUT",n,t)},n.prototype.AddListener=function(n,t){this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eventHandlers.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),Binder=function(){function n(){this.PrimaryKeys=[];this.eventHandlers=[];this.DataObjects=[];this.AssociatedElementIDs=[];this.AutomaticallyUpdatesToWebApi=!0;this.AutomaticallySelectsFromWebApi=!0;this.DataRowTemplates=[];this.IsFormBinding=!1}return n.prototype.WebApiGetParameters=function(){return null},n.prototype.Dispose=function(){var n=this,t=n.DataObject;n.PrimaryKeys=null;n.WebApi=null;n.AssociatedElementIDs=null;t&&(t.RemoveObjectStateListener(),t.RemovePropertyListeners());n.DataObjects.forEach(function(n){n.RemoveObjectStateListener();n.RemovePropertyListeners()});n.RemoveListeners()},n.prototype.Execute=function(n){var t;if(n===void 0&&(n=null),t=this,t.AutomaticallySelectsFromWebApi&&!Is.NullOrEmpty(t.WebApi)){var r=t.WebApiGetParameters()?t.WebApiGetParameters():n.Parameters,u=new Ajax,i=t.WebApi;u.AddListener(EventType.Completed,t.OnAjaxComplete.bind(this));r&&(i+=i.lastIndexOf("/")+1==i.length?"":"/",i+=Is.Array(r)?r.join("/"):r);u.Get(i)}else t.Dispatch(EventType.Completed)},n.prototype.OnAjaxComplete=function(n){var t=this,i;n.EventType===EventType.Completed&&(i=n.Sender.GetRequestData(),i&&(Is.Array(i)?i.forEach(function(n){return t.Add(t.NewObject(n))}):(t.IsFormBinding=!0,t.BindToDataObject(t.NewObject(i))),t.Dispatch(EventType.Completed)))},n.prototype.Delete=function(){},n.prototype.Add=function(n){var t=this;t.prepDataRowTemplates();t.DataRowTemplates.forEach(function(i){var r=i.CreateElementFromHtml(),u=r.Get(function(n){return n.HasDataSet()});u.Add(r);t.DataRowFooter?t.Element.insertBefore(r,t.DataRowFooter):t.Element.appendChild(r);t.DataObjects.Add(n);t.BindToDataObject(n,u)})},n.prototype.prepDataRowTemplates=function(){var i=this,t;if(i.DataRowTemplates.length==0){var n=i.Element.children,r=[],u=0;for(t=0;t<n.length;t++)n[t].getAttribute("data-template")!=null&&(r.Add(n[t]),u=t);n[n.length-1]!=r[r.length-1]&&(i.DataRowFooter=n[n.length-1]);r.forEach(function(n){i.DataRowTemplates.Add(n.outerHTML);n.parentElement.removeChild(n)})}},n.prototype.onObjectStateChanged=function(n){var t=this,i;t.AutomaticallyUpdatesToWebApi&&t.WebApi&&(i=new Ajax,i.AddListener(EventType.Completed,t.OnUpdateComplete.bind(this)),i.Put(t.WebApi,n.ServerObject),n.ObjectState=ObjectState.Clean)},n.prototype.OnUpdateComplete=function(n){var t=this,i=n.Sender.GetRequestData(),r=t.DataObject?t.DataObject:t.DataObjects.First(function(n){return t.IsPrimaryKeymatch(n,i)});r?t.SetServerObjectValue(r,i):null},n.prototype.SetServerObjectValue=function(n,t){for(var i in t)this.PrimaryKeys.First(function(n){return n===i})||n.SetServerProperty(i,t[i])},n.prototype.IsPrimaryKeymatch=function(n,t){for(var r=this,i=0;i<r.PrimaryKeys.length;i++)if(n.ServerObject[r.PrimaryKeys[i]]!=t[r.PrimaryKeys[i]])return!1;return!0},n.prototype.BindToDataObject=function(n,t){t===void 0&&(t=null);var i=this;t||(t=i.Element.Get(function(n){return n.HasDataSet()}),t.Add(i.Element));i.IsFormBinding&&(i.DataObject=n);n.AddObjectStateListener(i.onObjectStateChanged.bind(this));t.forEach(function(t){var r=t;i.setListeners(r,n)});n.AllPropertiesChanged()},n.prototype.setListeners=function(n,t){var i=n.GetDataSetAttributes(),r=this,o,s,h;if(n.tagName==="SELECT"){var u=i.First(function(n){return n.Attribute=="datasource"}),f=i.First(function(n){return n.Attribute=="displaymember"}),e=i.First(function(n){return n.Attribute=="valuemember"});u&&(o=new Function("return "+u.Property),s=o(),n.AddOptions(s,e?e.Property:null,f?f.Property:null))}h=["binder","datasource","displaymember","valuemember"];i.forEach(function(i){var f,u,e;h.First(function(n){return n===i.Attribute})||(f=r.getAttribute(i.Attribute),r.setObjectPropertyListener(i.Property,f,n,t),u=i.Attribute==="checked"&&n.type==="checkbox"?"checked":i.Attribute==="value"?"value":null,u&&(e=function(){t.OnElementChanged.bind(t)(n[u],i.Property)},n.addEventListener("change",e)))})},n.prototype.getAttribute=function(n){n=n.toLowerCase();switch(n){case"class":case"classname":return"className";case"innerhtml":return"innerHTML";case"readonly":return"readOnly";default:return n}},n.prototype.setObjectPropertyListener=function(n,t,i,r){var u=this,f=function(n,t){var r,f,e;Has.Properties(i,n)?i.tagName==="INPUT"&&i.type==="radio"?(r=i.parentElement.Get(function(n){return n.name===i.name&&n.type==="radio"}),r.forEach(function(n){return n.checked=!1}),f=r.First(function(n){return n.value===t.toString()}),f?f.checked=!0:null):n==="className"?(i.className=null,i.className=t):i[n]=t:(e=u.getStyle(n),e?i.style[e]=t:i[n]=t)};r.AddPropertyListener(n,t,f)},n.prototype.getStyle=function(n){for(var t in document.body.style)if(t.toLowerCase()===n.toLowerCase())return t;return null},Object.defineProperty(n.prototype,"SelectedObject",{get:function(){return this.selectedObject},set:function(n){this.selectedObject=n},enumerable:!0,configurable:!0}),n.prototype.AddListener=function(n,t){var i=this.eventHandlers.First(function(i){return i.EventType===n&&i.EventHandler===t});i||this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){n===void 0&&(n=EventType.Any);this.eventHandlers.Remove(function(t){return n===EventType.Any||t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),DataObject=function(){function n(n){n===void 0&&(n=null);this.changeCount=0;this.changeQueued=!1;this.eventListeners=[];this.objectListener=[];this.objectState=ObjectState.Clean;this.serverObject=n;this.objectState=ObjectState.Clean}return Object.defineProperty(n.prototype,"ObjectState",{get:function(){return this.objectState},set:function(n){var t=n!=this.objectState;this.objectState=n;n===ObjectState.Dirty&&this.OnObjectStateChanged()},enumerable:!0,configurable:!0}),n.prototype.AddPropertyListener=function(n,t,i){this.eventListeners.Add(new PropertyListener(n,t,i))},n.prototype.RemovePropertyListeners=function(){this.eventListeners.Remove(function(){return!0})},n.prototype.OnPropertyChanged=function(n){var t=this,i=this.eventListeners.Where(function(t){return t.PropertyName===n});i.forEach(function(i){return i.Handler(i.Attribute,t[n])})},n.prototype.AllPropertiesChanged=function(){var n=this;this.eventListeners.forEach(function(t){return t.Handler(t.Attribute,n[t.PropertyName])})},n.prototype.InstigatePropertyChangedListeners=function(n,t){t===void 0&&(t=!0);this.OnPropertyChanged(n);t&&this.ObjectState!=ObjectState.Cleaning&&(this.ObjectState=ObjectState.Dirty)},n.prototype.AddObjectStateListener=function(n){this.objectListener.Add(n)},n.prototype.RemoveObjectStateListener=function(){this.objectListener.Remove(function(){return!0})},n.prototype.OnObjectStateChanged=function(){var n=this;this.objectListener.forEach(function(t){return t(n)})},n.prototype.OnElementChanged=function(n,t){this[t]=n},Object.defineProperty(n.prototype,"ServerObject",{get:function(){return this.serverObject},set:function(n){this.serverObject=n},enumerable:!0,configurable:!0}),n.prototype.SetServerProperty=function(n,t){var i=t!=this.ServerObject[n];this.ServerObject[n]=t;i&&this.InstigatePropertyChangedListeners(n,!0)},n}(),CacheStrategy,HistoryContainer,HistoryManager,Initializer,Is,Has,ProgressManager;(function(n){n[n.ViewAndData=0]="ViewAndData";n[n.View=1]="View";n[n.Data=2]="Data"})(CacheStrategy||(CacheStrategy={}));var View=function(){function n(){this.eventHandlers=[];this.preload=null}return Object.defineProperty(n.prototype,"Preload",{get:function(){return this.preload},set:function(n){this.preload=n},enumerable:!0,configurable:!0}),n.prototype.Cache=function(n){var i,r,t;n===void 0&&(n=CacheStrategy.ViewAndData);this.Preload&&(n===CacheStrategy.ViewAndData||n===CacheStrategy.Data)&&this.Preload.Execute(function(){});i=sessionStorage.getItem(this.ViewUrl());i||n!==CacheStrategy.View&&n!==CacheStrategy.ViewAndData||(r=this,t=new Ajax,t.AddListener(EventType.Completed,function(n){r.RequestCompleted(n,!0)}),t.Get(this.ViewUrl()))},n.prototype.Show=function(n){this.ViewInstance=n;this.Preload?this.Preload.Execute(this.postPreloaded.bind(this)):this.postPreloaded()},n.prototype.postPreloaded=function(){var t=sessionStorage.getItem(this.ViewUrl()),n;!t||window.IsDebug?(n=new Ajax,n.AddListener(EventType.Completed,this.RequestCompleted.bind(this)),n.Get(this.ViewUrl())):this.SetHTML(t)},n.prototype.RequestCompleted=function(n,t){t===void 0&&(t=!1);n.Sender.ResponseText&&(sessionStorage.setItem(this.ViewUrl(),n.Sender.ResponseText),t||this.SetHTML(n.Sender.ResponseText));n.Sender=null},n.prototype.SetHTML=function(n){var t=this,r=this.ContainerID().Element(),i;Is.NullOrEmpty(r)?this.Dispatch(EventType.Completed):(this.cachedElement="div".CreateElement({innerHTML:n}),i=this.cachedElement.Get(function(n){return!Is.NullOrEmpty(n.getAttribute("data-binder"))}),this.countBindersReported=0,this.countBinders=0,i.length>0?(i.forEach(function(n){var i,r;try{i=n.getAttribute("data-binder");i&&(r=new Function("return new "+i+"()"),n.Binder=r(),n.Binder.AddListener(EventType.Completed,t.OnBinderComplete.bind(t)),n.Binder.Element=n,t.countBinders=t.countBinders+1)}catch(n){window.Exception(n)}}),i.forEach(function(n){if(n.Binder)try{n.Binder.Execute(t.ViewInstance)}catch(i){window.Exception(n)}})):this.MoveStuffFromCacheToReal())},n.prototype.OnBinderComplete=function(n){n.EventType===EventType.Completed&&(this.countBindersReported=this.countBindersReported+1,this.countBinders===this.countBindersReported&&this.MoveStuffFromCacheToReal())},n.prototype.MoveStuffFromCacheToReal=function(){var n=this.ContainerID().Element(),i=n.Get(function(n){return n.Binder!=null}),t;for(i.forEach(function(n){return n.Binder.Dispose()}),n.Clear();this.cachedElement.childNodes.length>0;)t=this.cachedElement.childNodes[0],this.cachedElement.removeChild(t),n.appendChild(t);this.Dispatch(EventType.Completed)},n.prototype.AddListener=function(n,t){var i=this.eventHandlers.First(function(i){return i.EventType===n&&i.EventHandler===t});i||this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eventHandlers.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),DataLoaders=function(){function n(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];this.completedCount=0;this._dataLoaders=t}return n.prototype.Execute=function(n){var t=this;this._callback=n;this.completedCount=0;this._dataLoaders.forEach(function(n){return n.Execute(t.Completed.bind(t))})},n.prototype.Completed=function(){this.completedCount++;this.completedCount===this._dataLoaders.length&&this._callback()},n}(),DataLoader=function(){function n(n,t,i,r){i===void 0&&(i=null);r===void 0&&(r=null);this._parameters=null;this._dataCallBack=t;this._dataUrl=n;this._shouldTryLoad=i}return n.prototype.Execute=function(n){if(this._completed=n,!this._shouldTryLoad||this._shouldTryLoad()){var t=new Ajax;t.AddListener(EventType.Completed,this._ajaxCompleted.bind(this));t.Get(this._dataUrl,this._parameters)}else this._completed()},n.prototype._ajaxCompleted=function(n){this._dataCallBack(n);this._completed()},n}(),ViewContainers=[],ViewContainer=function(){function n(){this.Views=[];this.IsDefault=!1}return n.prototype.Show=function(n){var t=this;this.NumberViewsShown=0;ProgressManager.Show();this.Views.forEach(function(i){i.AddListener(EventType.Completed,t.ViewLoadCompleted.bind(t));i.Show(n)})},n.prototype.IsUrlPatternMatch=function(n){var t=this.UrlPattern(),i;return t?(i=new RegExp(t,"i"),n.match(i)?!0:!1):!1},n.prototype.ViewLoadCompleted=function(n){n.EventType===EventType.Completed&&(this.NumberViewsShown=this.NumberViewsShown+1);this.NumberViewsShown===this.Views.length&&ProgressManager.Hide()},n}(),ViewInstance=function(){function n(n,t){this.Parameters=n;this.ViewContainer=t}return n}(),EventType;(function(n){n[n.Any=0]="Any";n[n.Completed=1]="Completed";n[n.Error=2]="Error";n[n.Aborted=3]="Aborted";n[n.Message=4]="Message"})(EventType||(EventType={}));var CustomEventArg=function(){function n(n,t){this.Cancel=!1;this.Sender=n;this.EventType=t}return n}(),Listener=function(){function n(n,t){this.EventType=n;this.EventHandler=t}return n}(),PropertyListener=function(){function n(n,t,i){this.PropertyName=n;this.Attribute=t;this.Handler=i}return n}(),ObjectState;(function(n){n[n.Dirty=0]="Dirty";n[n.Cleaning=1]="Cleaning";n[n.Clean=2]="Clean"})(ObjectState||(ObjectState={})),function(n){var t=function(){function n(){this.ViewInstances=[]}return n.prototype.CurrentRoute=function(){return this.ViewInstances!=null&&this.ViewInstances.length>0?this.ViewInstances[this.ViewInstances.length-1]:null},n.prototype.BackEvent=function(){HistoryManager.Back()},n.prototype.Add=function(n){this.ViewInstances.Add(n);this.ManageRouteInfo(n)},n.prototype.Back=function(){if(this.ViewInstances.length>1&&this.ViewInstances.splice(this.ViewInstances.length-1,1),this.ViewInstances.length>0){var n=this.ViewInstances[this.ViewInstances.length-1],t=n.ViewContainer;t.Show(n);this.ManageRouteInfo(n)}},n.prototype.ManageRouteInfo=function(n){var i=n.ViewContainer.UrlTitle(n),r=n.ViewContainer.DocumentTitle(n),t=n.ViewContainer.Url(n);t&&!Is.NullOrEmpty(i)&&history&&history.pushState&&(t=this.FormatUrl(Is.NullOrEmpty(t)?"/":t.indexOf("/")!=0?"/"+t:t),history.pushState(null,i,t));r&&(document.title=r)},n.prototype.FormatUrl=function(n){return n.replace(/[^A-z0-9/]/g,"")},n}();n.History=t}(HistoryContainer||(HistoryContainer={}));HistoryManager=new HistoryContainer.History,function(n){function i(n){if(document.readyState==="complete")t();else if(window.onload){var i=window.onload,r=function(){i(n);t()};window.onload=r}else window.onload=function(){t()}}function t(){r();e();window.ShowByUrl(window.location.pathname.substring(1));window.addEventListener("popstate",HistoryManager.BackEvent)}function r(){var r=o(),i,n,t;for(i in window)if(n=u(f(window[i]),r),!Is.NullOrEmpty(n))try{t=new Function("return new "+n+"();")();Has.Properties(t,"IsDefault","Views","Show","Url","UrlPattern","UrlTitle","IsUrlPatternMatch")&&ViewContainers.Add(t)}catch(e){window.Exception(e)}}function u(n,t){if(!Is.NullOrEmpty(n)){var i=n.match("^function\\s(\\w+)\\(\\)");if(i&&!t.First(function(n){return n===i[1]}))return i[1]}return null}function f(n){return n&&n.toString?n.toString():null}function e(){var n=document.getElementById("progress");n!=null&&Ajax&&(ProgressManager.ProgressElement=n)}function o(){return["Ajax","ViewContainer","View","ViewInstance","HistoryManager","Is","Initializer","ViewContainers","ActionEvent","DataBinding","ActionType","AutoSuggest","Binding","KeyPress","Thing","What"]}n.WindowLoad=i}(Initializer||(Initializer={}));Initializer.WindowLoad(),function(n){function t(n){return Object.prototype.toString.call(n)==="[object Array]"}function i(n){return n==null||n.length&&n.length===0}n.Array=t;n.NullOrEmpty=i}(Is||(Is={})),function(n){function t(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(i=0;i<r.length;i++)if(n[r[i]]===undefined)return!1;return!0}n.Properties=t}(Has||(Has={})),function(n){function t(){n.ProgressElement&&(n.ProgressElement.style.display="inline")}function i(){n.ProgressElement&&(n.ProgressElement.style.display="none")}n.ProgressElement=null;n.Show=t;n.Hide=i}(ProgressManager||(ProgressManager={}));Array.prototype.Add=function(){for(var i,n=[],t=0;t<arguments.length;t++)n[+t]=arguments[t];for(Is.Array(n)||(n=[n]),i=0;i<n.length;i++)this.push(n[i])};Array.prototype.First=function(n){var i=this.length,t;if(n){for(t=0;t<i;t++)if(n(this[t]))return this[t]}else if(i>0)return this[0];return null};Array.prototype.Last=function(n){var i=this.length,t;if(n)for(t=i-1;t>0;){if(n(this[t]))return this[t];t--}return i>0?this[i-1]:null};Array.prototype.Remove=function(n){var t,i;if(n)for(t=this.length-1;t>0;)i=n(this[t]),i&&this.splice(t,1),t--;return this};Array.prototype.Where=function(n){for(var i,r=[],t=0;t<this.length;t++)i=this[t],n(i)&&r.push(i);return r};Date.prototype.Add=function(n,t,i,r,u,f){return n=n?n:0,t=t?t:0,i=i?i:0,r=r?r:0,u=u?u:0,f=f?f:0,new Date(this.getFullYear()+n,this.getMonth()+t,this.getDate()+i,this.getHours()+r,this.getMinutes()+u,this.getSeconds()+f,this.getMilliseconds())};HTMLElement.prototype.Get=function(n,t,i){var u,r,f;for(i==null?i=[]:null,u=this.children,r=0;r<u.length;r++)u[r].nodeType==1&&u[r].tagName.toLowerCase()!="svg"&&(f=u[r],n(f)&&i.push(f),!t&&f.Get&&f.Get(n,t,i));return i};HTMLElement.prototype.First=function(n){for(var r,u,i=this.children,t=0;t<i.length;t++)if(i[t].nodeType==1&&i[t].tagName.toLowerCase()!="svg"&&(r=i[t],n(r)))return r;for(t=0;t<i.length;t++)if(i[t].nodeType==1&&i[t].tagName.toLowerCase()!="svg"&&(r=i[t],r.First&&(u=r.First(n),u)))return u;return null};HTMLElement.prototype.Clear=function(){for(var n=this,t=n.childNodes;t.length>0;)n.removeChild(t[0])};HTMLElement.prototype.AddListener=function(n,t){this.addEventListener?this.addEventListener(n,t):this.attachEvent(n,t)};HTMLElement.prototype.Set=function(n){var i=this,t;if(n)for(t in n)t!="cls"&&t!="className"?t.IsStyle()?i.style[t]=n[t]:t==="style"?n.style.cssText&&(i.style.cssText=n.style.cssText):i[t]=n[t]:(i.className=null,i.className=n[t]);return i};HTMLElement.prototype.HasDataSet=function(){var n=this.dataset,t;if(n)for(t in n)return!0;return!1};HTMLElement.prototype.GetDataSetAttributes=function(){var i=[],n=this.dataset,t;if(n)for(t in n)i.Add({Attribute:t,Property:n[t]});return i};HTMLSelectElement.prototype.AddOptions=function(n,t,i,r){var o=this,u=n,s=function(n,t){var i=new Option(n,t);o.options[o.options.length]=i;r&&t===r&&(i.selected=!0)},f;if(Is.Array(u)){var e=u,h=i,c=t;h&&c?e.forEach(function(n){s(n[h],n[c])}):e.length>1&&typeof e[0]=="string"&&e.forEach(function(n){s(n,n)})}else if(u)for(f in u)u[f]&&{}.toString.call(u[f])==="[object Function]"||s(u[f],u[f]);return o};String.prototype.Trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.Element=function(){var n=document.getElementById(this.toString());return n?n:null};String.prototype.CreateElement=function(n){var t=document.createElement(this);return n&&t.Set(n),t};String.prototype.CreateElementFromHtml=function(){for(var t="div".CreateElement({innerHTML:this}),n=t.children;n.length>0;)return n[n.length-1]};String.prototype.IsStyle=function(){for(var n in document.body.style)if(n.toLowerCase()===this.toLowerCase())return!0;return!1};Window.prototype.Exception=function(){for(var r,t,n=[],i=0;i<arguments.length;i++)n[+i]=arguments[i];if(n.length==1){for(r={},t=0;t<n.length;t++)r["parameter"+t]=n[t];alert(JSON.stringify(r))}else n.length>1?alert(JSON.stringify(n[0])):alert("Unknown error")};Window.prototype.Show=function(n,t){var i=new n,r=new ViewInstance(t,i);i.Show(r);HistoryManager.Add(r)};Window.prototype.ShowByUrl=function(n){var t=ViewContainers.First(function(t){return t.IsUrlPatternMatch(n)}),r,i;t=t==null?ViewContainers.First(function(n){return n.IsDefault}):t;t&&(r=n.split("/"),i=new ViewInstance(r,t),t.Show(i),HistoryManager.Add(i))};