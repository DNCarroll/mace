var Ajax = function () { function a() { this.DisableElement = null, this.ManipulateProgressElement = !1, this.UseAsDateUTC = !0, this.ContentType = "application/json; charset=utf-8", this.eventHandlers = new Array } return Object.defineProperty(a.prototype, "ResponseText", { get: function () { return this.XMLHttpRequest.responseText }, enumerable: !0, configurable: !0 }), a.prototype.Submit = function (a, b, c) { void 0 === c && (c = null); var d = this; d.showProgress(), b = d.getUrl(b), d.XMLHttpRequest = new XMLHttpRequest; var e = d.XMLHttpRequest; e.addEventListener("readystatechange", d.onReaderStateChange.bind(d), !1), e.open(a, b, !0), e.setRequestHeader("content-type", d.ContentType), d.setCustomHeader(); try { e.send(d.getParameters(c)) } catch (a) { d.HideProgress(), window.Exception(a) } }, a.prototype.onReaderStateChange = function (a) { this.isRequestReady() && (this.HideProgress(), this.Dispatch(EventType.Completed)) }, a.prototype.showProgress = function () { this.showHideProgress(!0) }, a.prototype.getUrl = function (b) { return b.indexOf("http") != -1 || Is.NullOrEmpty(a.Host) || (b = a.Host + (0 == b.indexOf("/") ? b : "/" + b)), b }, a.prototype.isRequestReady = function () { var a = this.XMLHttpRequest; return a && 4 == a.readyState }, a.prototype.HideProgress = function () { this.showHideProgress(!1) }, a.prototype.showHideProgress = function (a) { if (this.ManipulateProgressElement) { a ? ProgressManager.Show() : ProgressManager.Hide(); var b = this.DisableElement, c = "disabled", d = function (b) { a ? b.setAttribute(c, c) : b.removeAttribute(c) }; if (b) if (Is.Array(b)) for (var e = 0; e < b.length; e++) d(b[e]); else d(b) } }, a.prototype.setCustomHeader = function () { var a = this; if (a.Header) { var b = a.Header(); if (b) for (var c in b) a.XMLHttpRequest.setRequestHeader(c, b[c]) } }, a.prototype.getParameters = function (a) { var b = ""; return a && "application/json; charset=utf-8" === this.ContentType && (b = JSON.stringify(a).replace(/\\\"__type\\\"\:\\\"[\w+\.?]+\\\"\,/g, "").replace(/\"__type\"\:\"[\w+\.?]+\"\,/g, "").replace(/<script/gi, "").replace(/script>/gi, "")), b }, a.prototype.GetRequestData = function () { var a = null, b = this, c = this.XMLHttpRequest; if (b.isRequestReady() && (200 == c.status || 204 == c.status) && !Is.NullOrEmpty(c.responseText)) { a = c.responseText; try { a = JSON.parse(a), a.d && (a = a.d), b.convertProperties(a) } catch (b) { a = null, window.Exception(b) } } return a }, a.prototype.convertProperties = function (a) { var b, c = this; if (Is.Array(a)) for (var d = 0; d < a.length; d++) { var e = a[d]; if (e) { try { b = b ? b : c.getKeyMap(e) } catch (a) { window.Exception(a) } c.setValues(e, b) } for (var f in e) c.convertProperties(e[f]) } else if (a && "object" == typeof a) { b = c.getKeyMap(a), c.setValues(a, b); for (var f in a) c.convertProperties(a[f]) } }, a.prototype.getKeyMap = function (a) { var b = new Array; for (var c in a) { var d = a[c]; d && "string" == typeof d && (d = d.Trim(), 0 == d.indexOf("/Date(") || 0 == d.indexOf("Date(") ? b.push({ Key: c, Type: "Date" }) : d.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/i) ? b.push({ Key: c, Type: "UTCDate" }) : d.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/g) && b.push({ Key: c, Type: "ZDate" })) } return b }, a.prototype.setValues = function (a, b) { for (var c = 0; c < b.length; c++) { var d = b[c].Key, e = b[c].Type, f = a[d]; switch (e) { case "Date": f ? (f = parseInt(f.substring(6).replace(")/", "")), f > -621355752e5 ? (f = new Date(f), a[d] = f) : delete a[d]) : a[d] = new Date; break; case "UTCDate": case "ZDate": var g = new Date(f); if (this.UseAsDateUTC) g = new Date(g.getUTCFullYear(), g.getUTCMonth(), g.getUTCDate()); else if (window.chrome) { var h = (new Date).getTimezoneOffset(); g = g.Add(0, 0, 0, 0, h) } a[d] = g } } }, a.prototype.Get = function (a, b) { void 0 === b && (b = null), this.Submit("GET", a, b) }, a.prototype.Put = function (a, b) { void 0 === b && (b = null), this.Submit("PUT", a, b) }, a.prototype.Post = function (a, b) { void 0 === b && (b = null), this.Submit("POST", a, b) }, a.prototype.Delete = function (a, b) { void 0 === b && (b = null), this.Submit("DELETE", a, b) }, a.prototype.AddListener = function (a, b) { this.eventHandlers.Add(new Listener(a, b)) }, a.prototype.RemoveListener = function (a, b) { this.eventHandlers.Remove(function (c) { return c.EventType === a && b === b }) }, a.prototype.RemoveListeners = function (a) { this.eventHandlers.Remove(function (b) { return b.EventType === a }) }, a.prototype.Dispatch = function (a) { var b = this, c = this.eventHandlers.Where(function (b) { return b.EventType === a }); c.forEach(function (c) { return c.EventHandler(new CustomEventArg(b, a)) }) }, a }(), Binder = function () { function a() { this.PrimaryKeys = new Array, this.eventHandlers = new Array, this.DataObjects = new Array, this.AutomaticUpdate = !0, this.AutomaticSelect = !0, this.DataRowTemplates = new Array, this.IsFormBinding = !1 } return a.prototype.WebApiGetParameters = function () { return null }, a.prototype.Dispose = function () { var a = this, b = a.DataObject; a.PrimaryKeys = null, a.WebApi = null, b && (b.RemoveObjectStateListener(), b.RemovePropertyListeners()), a.DataObjects.forEach(function (a) { a.RemoveObjectStateListener(), a.RemovePropertyListeners() }), a.RemoveListeners() }, a.prototype.Execute = function (a) { void 0 === a && (a = null); var b = this; if (b.AutomaticSelect && !Is.NullOrEmpty(b.WebApi)) { var c = b.WebApiGetParameters() ? b.WebApiGetParameters() : a.Parameters, d = new Ajax, e = b.WebApi; d.AddListener(EventType.Completed, b.OnAjaxComplete.bind(this)), c && (e += e.lastIndexOf("/") + 1 == e.length ? "" : "/", e += Is.Array(c) ? c.join("/") : c), d.Get(e) } else b.Dispatch(EventType.Completed) }, a.prototype.OnAjaxComplete = function (a) { var b = this; if (a.EventType === EventType.Completed) { var c = a.Sender.GetRequestData(); c && (Is.Array(c) ? c.forEach(function (a) { return b.Add(b.NewObject(a)) }) : (b.IsFormBinding = !0, b.Bind(b.NewObject(c))), b.Dispatch(EventType.Completed)) } }, a.prototype.Delete = function (a) { }, a.prototype.Add = function (a) { var b = this; b.prepDataRowTemplates(), b.DataRowTemplates.forEach(function (c) { var d = c.CreateElementFromHtml(), e = d.Get(function (a) { return a.HasDataSet() }); e.Add(d), b.DataRowFooter ? b.Element.insertBefore(d, b.DataRowFooter) : b.Element.appendChild(d), b.DataObjects.Add(a), b.Bind(a, e) }) }, a.prototype.prepDataRowTemplates = function () { var a = this; if (0 == a.DataRowTemplates.length) { for (var b = a.Element.children, c = new Array, d = 0, e = 0; e < b.length; e++) null != b[e].getAttribute("data-template") && (c.Add(b[e]), d = e); b[b.length - 1] != c[c.length - 1] && (a.DataRowFooter = b[b.length - 1]), c.forEach(function (b) { a.DataRowTemplates.Add(b.outerHTML), b.parentElement.removeChild(b) }) } }, a.prototype.onObjectStateChanged = function (a) { var b = this; if (b.AutomaticUpdate && b.WebApi) { var c = new Ajax; c.AddListener(EventType.Completed, b.OnUpdateComplete.bind(this)), c.Put(b.WebApi, a.ServerObject), a.ObjectState = ObjectState.Clean } }, a.prototype.OnUpdateComplete = function (a) { var b = this, c = a.Sender.GetRequestData(), d = b.DataObject ? b.DataObject : b.DataObjects.First(function (a) { return b.isPKMatch(a, c) }); d ? b.SetServerObjectValue(d, c) : null }, a.prototype.SetServerObjectValue = function (a, b) { for (var c in b) this.PrimaryKeys.First(function (a) { return a === c }) || a.SetServerProperty(c, b[c]) }, a.prototype.isPKMatch = function (a, b) { for (var c = this, d = 0; d < c.PrimaryKeys.length; d++) if (a.ServerObject[c.PrimaryKeys[d]] != b[c.PrimaryKeys[d]]) return !1; return !0 }, a.prototype.Bind = function (a, b) { void 0 === b && (b = null); var c = this; b || (b = c.Element.Get(function (a) { return a.HasDataSet() }), b.Add(c.Element)), c.IsFormBinding && (c.DataObject = a), a.AddObjectStateListener(c.onObjectStateChanged.bind(this)), b.forEach(function (b) { var d = b; c.setListeners(d, a) }), a.AllPropertiesChanged() }, a.prototype.setListeners = function (a, b) { var c = a.GetDataSetAttributes(), d = this; if ("SELECT" === a.tagName) { var e = c.First(function (a) { return "datasource" == a.Attribute }), f = c.First(function (a) { return "displaymember" == a.Attribute }), g = c.First(function (a) { return "valuemember" == a.Attribute }); if (e) { var h = new Function("return " + e.Property), i = h(); a.AddOptions(i, g ? g.Property : null, f ? f.Property : null) } } var j = ["binder", "datasource", "displaymember", "valuemember"]; c.forEach(function (c) { if (!j.First(function (a) { return a === c.Attribute })) { var e = d.getAttribute(c.Attribute); d.setObjectPropertyListener(c.Property, e, a, b); var f = "checked" === c.Attribute && "checkbox" === a.type ? "checked" : "value" === c.Attribute ? "value" : null; if (f) { var g = function (d) { b.OnElementChanged.bind(b)(a[f], c.Property) }; a.addEventListener("change", g) } } }) }, a.prototype.getAttribute = function (a) { switch (a = a.toLowerCase()) { case "class": case "classname": return "className"; case "innerhtml": return "innerHTML"; case "readonly": return "readOnly"; default: return a } }, a.prototype.setObjectPropertyListener = function (a, b, c, d) { var e = this, f = function (a, b) { if (Has.Properties(c, a)) if ("INPUT" === c.tagName && "radio" === c.type) { var d = c.parentElement.Get(function (a) { return a.name === c.name && "radio" === a.type }); d.forEach(function (a) { return a.checked = !1 }); var f = d.First(function (a) { return a.value === b.toString() }); f ? f.checked = !0 : null } else "className" === a ? (c.className = null, c.className = b) : c[a] = b; else { var g = e.getStyle(a); g ? c.style[g] = b : c[a] = b } }; d.AddPropertyListener(a, b, f) }, a.prototype.getStyle = function (a) { for (var b in document.body.style) if (b.toLowerCase() === a.toLowerCase()) return b; return null }, Object.defineProperty(a.prototype, "SelectedObject", { get: function () { return this.selectedObject }, set: function (a) { this.selectedObject = a }, enumerable: !0, configurable: !0 }), a.prototype.AddListener = function (a, b) { var c = this.eventHandlers.First(function (c) { return c.EventType === a && c.EventHandler === b }); c || this.eventHandlers.Add(new Listener(a, b)) }, a.prototype.RemoveListener = function (a, b) { this.eventHandlers.Remove(function (c) { return c.EventType === a && b === b }) }, a.prototype.RemoveListeners = function (a) { void 0 === a && (a = EventType.Any), this.eventHandlers.Remove(function (b) { return a === EventType.Any || b.EventType === a }) }, a.prototype.Dispatch = function (a) { var b = this, c = this.eventHandlers.Where(function (b) { return b.EventType === a }); c.forEach(function (c) { return c.EventHandler(new CustomEventArg(b, a)) }) }, a }(), DataObject = function () { function a(a) { void 0 === a && (a = null), this.changeCount = 0, this.changeQueued = !1, this.eLstenrs = new Array, this.oLstenrs = new Array, this.objectState = ObjectState.Clean, this.serverObject = a, this.objectState = ObjectState.Clean } return Object.defineProperty(a.prototype, "ObjectState", { get: function () { return this.objectState }, set: function (a) { var b = this; b.objectState = a, a === ObjectState.Dirty && b.OnObjectStateChanged() }, enumerable: !0, configurable: !0 }), a.prototype.AddPropertyListener = function (a, b, c) { this.eLstenrs.Add(new PropertyListener(a, b, c)) }, a.prototype.RemovePropertyListeners = function () { this.eLstenrs.Remove(function (a) { return !0 }) }, a.prototype.OnPropertyChanged = function (a) { var b = this, c = this.eLstenrs.Where(function (b) { return b.PropertyName === a }); c.forEach(function (c) { return c.Handler(c.Attribute, b[a]) }) }, a.prototype.AllPropertiesChanged = function () { var a = this; this.eLstenrs.forEach(function (b) { return b.Handler(b.Attribute, a[b.PropertyName]) }) }, a.prototype.InstigatePropertyChangedListeners = function (a, b) { void 0 === b && (b = !0), this.OnPropertyChanged(a), b && this.ObjectState != ObjectState.Cleaning && (this.ObjectState = ObjectState.Dirty) }, a.prototype.AddObjectStateListener = function (a) { this.oLstenrs.Add(a) }, a.prototype.RemoveObjectStateListener = function () { this.oLstenrs.Remove(function (a) { return !0 }) }, a.prototype.OnObjectStateChanged = function () { var a = this; this.oLstenrs.forEach(function (b) { return b(a) }) }, a.prototype.OnElementChanged = function (a, b) { this[b] = a }, Object.defineProperty(a.prototype, "ServerObject", { get: function () { return this.serverObject }, set: function (a) { this.serverObject = a }, enumerable: !0, configurable: !0 }), a.prototype.SetServerProperty = function (a, b) { var c = this, d = b != c.ServerObject[a]; c.ServerObject[a] = b, d && this.InstigatePropertyChangedListeners(a, !0) }, a }(), CacheStrategy; !function (a) { a[a.ViewAndData = 0] = "ViewAndData", a[a.View = 1] = "View", a[a.Data = 2] = "Data" }(CacheStrategy || (CacheStrategy = {})); var View = function () { function a() { this.eHandlrs = new Array, this.preload = null } return Object.defineProperty(a.prototype, "Preload", { get: function () { return this.preload }, set: function (a) { this.preload = a }, enumerable: !0, configurable: !0 }), a.prototype.Cache = function (a) { void 0 === a && (a = CacheStrategy.ViewAndData), !this.Preload || a !== CacheStrategy.ViewAndData && a !== CacheStrategy.Data || this.Preload.Execute(function () { }); var b = sessionStorage.getItem(this.ViewUrl()); if (!b && (a === CacheStrategy.View || a === CacheStrategy.ViewAndData)) { var c = this, d = new Ajax; d.AddListener(EventType.Completed, function (a) { c.RequestCompleted(a, !0) }), d.Get(this.ViewUrl()) } }, a.prototype.Show = function (a) { this.ViewInstance = a, this.Preload ? this.Preload.Execute(this.postPreloaded.bind(this)) : this.postPreloaded() }, a.prototype.postPreloaded = function () { var a = sessionStorage.getItem(this.ViewUrl()); if (!a || window.IsDebug) { var b = new Ajax; b.AddListener(EventType.Completed, this.RequestCompleted.bind(this)), b.Get(this.ViewUrl()) } else this.SetHTML(a) }, a.prototype.RequestCompleted = function (a, b) { void 0 === b && (b = !1), a.Sender.ResponseText && (sessionStorage.setItem(this.ViewUrl(), a.Sender.ResponseText), b || this.SetHTML(a.Sender.ResponseText)), a.Sender = null }, a.prototype.SetHTML = function (a) { var b = this, c = this.ContainerID().Element(); if (Is.NullOrEmpty(c)) this.Dispatch(EventType.Completed); else { this.cached = "div".CreateElement({ innerHTML: a }); var d = this.cached.Get(function (a) { return !Is.NullOrEmpty(a.getAttribute("data-binder")) }); this.countBindersReported = 0, this.countBinders = 0, d.length > 0 ? (d.forEach(function (a) { try { var c = a.getAttribute("data-binder"); if (c) { var d = new Function("return new " + c + "()"); a.Binder = d(), a.Binder.AddListener(EventType.Completed, b.OnBinderComplete.bind(b)), a.Binder.Element = a, b.countBinders = b.countBinders + 1 } } catch (a) { window.Exception(a) } }), d.forEach(function (a) { if (a.Binder) try { a.Binder.Execute(b.ViewInstance) } catch (b) { window.Exception(a) } })) : this.MoveStuffFromCacheToReal() } }, a.prototype.OnBinderComplete = function (a) { a.EventType === EventType.Completed && (this.countBindersReported = this.countBindersReported + 1, this.countBinders === this.countBindersReported && this.MoveStuffFromCacheToReal()) }, a.prototype.MoveStuffFromCacheToReal = function () { var a = this.ContainerID().Element(), b = a.Get(function (a) { return null != a.Binder }); for (b.forEach(function (a) { return a.Binder.Dispose() }), a.Clear() ; this.cached.childNodes.length > 0;) { var c = this.cached.childNodes[0]; this.cached.removeChild(c), a.appendChild(c) } this.Dispatch(EventType.Completed) }, a.prototype.AddListener = function (a, b) { var c = this.eHandlrs.First(function (c) { return c.EventType === a && c.EventHandler === b }); c || this.eHandlrs.Add(new Listener(a, b)) }, a.prototype.RemoveListener = function (a, b) { this.eHandlrs.Remove(function (c) { return c.EventType === a && b === b }) }, a.prototype.RemoveListeners = function (a) { this.eHandlrs.Remove(function (b) { return b.EventType === a }) }, a.prototype.Dispatch = function (a) { var b = this, c = this.eHandlrs.Where(function (b) { return b.EventType === a }); c.forEach(function (c) { return c.EventHandler(new CustomEventArg(b, a)) }) }, a }(), DataLoaders = function () { function a() { for (var a = [], b = 0; b < arguments.length; b++) a[b - 0] = arguments[b]; this.completedCount = 0, this._dataLoaders = a } return a.prototype.Execute = function (a) { var b = this; this._callback = a, this.completedCount = 0, this._dataLoaders.forEach(function (a) { return a.Execute(b.Completed.bind(b)) }) }, a.prototype.Completed = function () { this.completedCount++, this.completedCount === this._dataLoaders.length && this._callback() }, a }(), DataLoader = function () { function a(a, b, c, d) { void 0 === c && (c = null), void 0 === d && (d = null), this._parameters = null, this._dataCallBack = b, this._dataUrl = a, this._shouldTryLoad = c } return a.prototype.Execute = function (a) { if (this._completed = a, !this._shouldTryLoad || this._shouldTryLoad()) { var b = new Ajax; b.AddListener(EventType.Completed, this._ajaxCompleted.bind(this)), b.Get(this._dataUrl, this._parameters) } else this._completed() }, a.prototype._ajaxCompleted = function (a) { this._dataCallBack(a), this._completed() }, a }(), ViewContainers = new Array, ViewContainer = function () { function a() { this.Views = new Array, this.IsDefault = !1 } return a.prototype.Show = function (a) { var b = this; this.NumberViewsShown = 0, ProgressManager.Show(), this.Views.forEach(function (c) { c.AddListener(EventType.Completed, b.ViewLoadCompleted.bind(b)), c.Show(a) }) }, a.prototype.IsUrlPatternMatch = function (a) { var b = this.UrlPattern(); if (b) { var c = new RegExp(b, "i"); return !!a.match(c) } return !1 }, a.prototype.ViewLoadCompleted = function (a) { a.EventType === EventType.Completed && (this.NumberViewsShown = this.NumberViewsShown + 1), this.NumberViewsShown === this.Views.length && ProgressManager.Hide() }, a }(), ViewInstance = function () { function a(a, b) { this.Parameters = a, this.ViewContainer = b } return a }(), EventType; !function (a) { a[a.Any = 0] = "Any", a[a.Completed = 1] = "Completed", a[a.Error = 2] = "Error", a[a.Aborted = 3] = "Aborted", a[a.Message = 4] = "Message" }(EventType || (EventType = {})); var CustomEventArg = function () { function a(a, b) { this.Cancel = !1, this.Sender = a, this.EventType = b } return a }(), Listener = function () { function a(a, b) { this.EventType = a, this.EventHandler = b } return a }(), PropertyListener = function () { function a(a, b, c) { this.PropertyName = a, this.Attribute = b, this.Handler = c } return a }(), ObjectState; !function (a) { a[a.Dirty = 0] = "Dirty", a[a.Cleaning = 1] = "Cleaning", a[a.Clean = 2] = "Clean" }(ObjectState || (ObjectState = {})); var HistoryContainer; !function (a) { var b = function () { function a() { this.ViewInstances = new Array } return a.prototype.CurrentRoute = function () { var a = this.ViewInstances; return null != a && a.length > 0 ? a[a.length - 1] : null }, a.prototype.BackEvent = function (a) { HistoryManager.Back() }, a.prototype.Add = function (a) { this.ViewInstances.Add(a), this.ManageRouteInfo(a) }, a.prototype.Back = function () { var a = this.ViewInstances; if (a.length > 1 && a.splice(a.length - 1, 1), a.length > 0) { var b = a[a.length - 1], c = b.ViewContainer; c.Show(b), this.ManageRouteInfo(b) } }, a.prototype.ManageRouteInfo = function (a) { var b = a, c = b.ViewContainer, d = c.UrlTitle(b), e = c.DocumentTitle(b), f = history, g = c.Url(b); g && !Is.NullOrEmpty(d) && f && f.pushState && (g = this.FormatUrl(Is.NullOrEmpty(g) ? "/" : 0 != g.indexOf("/") ? "/" + g : g), f.pushState(null, d, g)), e && (document.title = e) }, a.prototype.FormatUrl = function (a) { return a = a.replace(/[^A-z0-9\/]/g, "") }, a }(); a.History = b }(HistoryContainer || (HistoryContainer = {})); var HistoryManager = new HistoryContainer.History, Initializer; !function (a) { function b(a) { var b = window; if ("complete" === document.readyState) c(); else if (b.onload) { var d = b.onload, e = function () { d(a), c() }; b.onload = e } else b.onload = function () { c() } } function c() { var a = window; d(), g(), a.ShowByUrl(a.location.pathname.substring(1)), a.addEventListener("popstate", HistoryManager.BackEvent) } function d() { var a = h(), b = window; for (var c in b) { var d = e(f(b[c]), a); if (!Is.NullOrEmpty(d)) try { var g = new Function("return new " + d + "();")(); Has.Properties(g, "IsDefault", "Views", "Show", "Url", "UrlPattern", "UrlTitle", "IsUrlPatternMatch") && ViewContainers.Add(g) } catch (a) { b.Exception(a) } } } function e(a, b) { var c = a; if (!Is.NullOrEmpty(c)) { var d = "^function\\s(\\w+)\\(\\)", e = c.match(d); if (e && !b.First(function (a) { return a === e[1] })) return e[1] } return null } function f(a) { return a && a.toString ? a.toString() : null } function g() { var a = document.getElementById("progress"); null != a && (ProgressManager.ProgressElement = a) } function h() { return ["Ajax", "Binder", "DataObject", "View", "ViewContainer", "ViewContainers", "ViewInstance", "EventType", "CustomEventArg", "Listener", "PropertyListener", "ObjectState", "HistoryManager", "Initializer", "Is", "ProgressManager"] } a.WindowLoad = b }(Initializer || (Initializer = {})), Initializer.WindowLoad(); var Is; !function (a) { function b(a) { return "[object Array]" === Object.prototype.toString.call(a) } function c(a) { return null == a || a.length && 0 === a.length } a.Array = b, a.NullOrEmpty = c }(Is || (Is = {})); var Has; !function (a) { function b(a) { for (var b = [], c = 1; c < arguments.length; c++) b[c - 1] = arguments[c]; for (var d = b, e = 0; e < d.length; e++) if (void 0 === a[d[e]]) return !1; return !0 } a.Properties = b }(Has || (Has = {})); var ProgressManager; !function (a) { function b() { var b = a.ProgressElement; b && (b.style.display = "inline") } function c() { var b = a.ProgressElement; b && (b.style.display = "none") } a.ProgressElement = null, a.Show = b, a.Hide = c }(ProgressManager || (ProgressManager = {})), Array.prototype.Add = function () { for (var a = [], b = 0; b < arguments.length; b++) a[b - 0] = arguments[b]; var c = a; Is.Array(c) || (c = [c]); for (var d = 0; d < c.length; d++) this.push(c[d]) }, Array.prototype.First = function (a) { var b = this, c = b.length; if (a) { for (var d = 0; d < c; d++) if (a(b[d])) return b[d] } else if (c > 0) return b[0]; return null }, Array.prototype.Last = function (a) { var b = this, c = b.length; if (a) for (var d = c - 1; d > 0;) { if (a(b[d])) return b[d]; d-- } return c > 0 ? b[c - 1] : null }, Array.prototype.Remove = function (a) { var b = this; if (a) for (var c = b.length - 1; c > 0;) a(b[c]) && b.splice(c, 1), c--; return b }, Array.prototype.Where = function (a) { for (var b = new Array, c = 0; c < this.length; c++) { var d = this[c]; a(d) && b.push(d) } return b }, Date.prototype.Add = function (a, b, c, d, e, f) { a = a ? a : 0, b = b ? b : 0, c = c ? c : 0, d = d ? d : 0, e = e ? e : 0, f = f ? f : 0; var g = this; return new Date(g.getFullYear() + a, g.getMonth() + b, g.getDate() + c, g.getHours() + d, g.getMinutes() + e, g.getSeconds() + f, g.getMilliseconds()) }, HTMLElement.prototype.Get = function (a, b, c) { for (var d = null == c ? new Array : c, e = this.children, f = 0; f < e.length; f++) { var g = e[f]; 1 == g.nodeType && "svg" != g.tagName.toLowerCase() && (a(g) && d.push(g), !b && g.Get && g.Get(a, b, d)) } return d }, HTMLElement.prototype.First = function (a) { for (var b = this.children, c = 0; c < b.length; c++) { var d = b[c]; if (1 == d.nodeType && "svg" != d.tagName.toLowerCase() && a(d)) return d } for (var c = 0; c < b.length; c++) { var d = b[c]; if (1 == d.nodeType && "svg" != d.tagName.toLowerCase() && d.First) { var e = d.First(a); if (e) return e } } return null }, HTMLElement.prototype.Clear = function () { for (var a = this, b = a.childNodes; b.length > 0;) a.removeChild(b[0]) }, HTMLElement.prototype.AddListener = function (a, b) { this.addEventListener ? this.addEventListener(a, b) : this.attachEvent(a, b) }, HTMLElement.prototype.Set = function (a) { var b = this, c = a; if (c) for (var d in c) "cls" != d && "className" != d ? d.IsStyle() ? b.style[d] = c[d] : "style" === d ? c.style.cssText && (b.style.cssText = c.style.cssText) : b[d] = c[d] : (b.className = null, b.className = c[d]); return b }, HTMLElement.prototype.HasDataSet = function () { var a = this.dataset; if (a) for (var b in a) return !0; return !1 }, HTMLElement.prototype.GetDataSetAttributes = function () { var a = new Array, b = this.dataset; if (b) for (var c in b) a.Add({ Attribute: c, Property: b[c] }); return a }, HTMLSelectElement.prototype.AddOptions = function (a, b, c, d) { var e = this, f = d, g = a, h = function (a, b) { var c = new Option(a, b); e.options[e.options.length] = c, f && b === f && (c.selected = !0) }; if (Is.Array(g)) { var i = g, j = c, k = b; j && k ? i.forEach(function (a) { h(a[j], a[k]) }) : i.length > 1 && "string" == typeof i[0] && i.forEach(function (a) { h(a, a) }) } else if (g) for (var l in g) g[l] && "[object Function]" === {}.toString.call(g[l]) || h(g[l], g[l]); return e }, String.prototype.Trim = function () { return this.replace(/^\s+|\s+$/g, "") }, String.prototype.Element = function () { var a = document.getElementById(this.toString()); return a ? a : null }, String.prototype.CreateElement = function (a) { var b = document.createElement(this), c = a; return c && b.Set(c), b }, String.prototype.CreateElementFromHtml = function () { for (var a = "div".CreateElement({ innerHTML: this }), b = a.children; b.length > 0;) { var c = b[b.length - 1]; return c } }, String.prototype.IsStyle = function () { for (var a in document.body.style) if (a.toLowerCase() === this.toLowerCase()) return !0; return !1 }, Window.prototype.Exception = function () { for (var a = [], b = 0; b < arguments.length; b++) a[b - 0] = arguments[b]; if (1 == a.length) { for (var c = {}, d = 0; d < a.length; d++) c["parameter" + d] = a[d]; alert(JSON.stringify(c)) } else a.length > 1 ? alert(JSON.stringify(a[0])) : alert("Unknown error") }, Window.prototype.Show = function (a, b) { var c = new a, d = new ViewInstance(b, c); c.Show(d), HistoryManager.Add(d) }, Window.prototype.ShowByUrl = function (a) { var b = ViewContainers.First(function (b) { return b.IsUrlPatternMatch(a) }); if (b = null == b ? ViewContainers.First(function (a) { return a.IsDefault }) : b) { var c = a.split("/"), d = new ViewInstance(c, b); b.Show(d), HistoryManager.Add(d) } };