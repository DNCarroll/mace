var Ajax = function () { function e() { this.DisableElement = null, this.ManipulateProgressElement = !1, this.UseAsDateUTC = !0, this.ContentType = "application/json; charset=utf-8", this.eventHandlers = new Array } return Object.defineProperty(e.prototype, "ResponseText", { get: function () { return this.XHttp.responseText }, enumerable: !0, configurable: !0 }), e.prototype.Submit = function (e, t, n) { void 0 === n && (n = null); var r = this; r.Progress(), t = r.getUrl(t), r.XHttp = new XMLHttpRequest; var o = r.XHttp; o.addEventListener("readystatechange", r.xStateChanged.bind(r), !1), o.open(e, t, !0), o.setRequestHeader("content-type", r.ContentType), r.setHead(); try { o.send(r.getParameters(n)) } catch (i) { r.Progress(!1), window.Exception(i) } }, e.prototype.xStateChanged = function (e) { var t = this, n = t.XHttp; t.isRequestReady() && (t.Progress(!1), t.Dispatch(200 === n.status || 204 === n.status ? EventType.Completed : EventType.Error)) }, e.prototype.getUrl = function (t) { return -1 != t.indexOf("http") || Is.NullOrEmpty(e.Host) || (t = e.Host + (0 == t.indexOf("/") ? t : "/" + t)), t }, e.prototype.isRequestReady = function () { var e = this.XHttp; return e && 4 == e.readyState }, e.prototype.Progress = function (e) { if (void 0 === e && (e = !0), this.ManipulateProgressElement) { e ? ProgressManager.Show() : ProgressManager.Hide(); var t = this.DisableElement, n = "disabled", r = function (t) { e ? t.setAttribute(n, n) : t.removeAttribute(n) }; if (t) if (Is.Array(t)) for (var o = 0; o < t.length; o++) r(t[o]); else r(t) } }, e.prototype.setHead = function () { var e = this; if (e.Header) { var t = e.Header(); if (t) for (var n in t) e.XHttp.setRequestHeader(n, t[n]) } }, e.prototype.getParameters = function (e) { var t = ""; return e && "application/json; charset=utf-8" === this.ContentType && (t = JSON.stringify(e).replace(/\\\"__type\\\"\:\\\"[\w+\.?]+\\\"\,/g, "").replace(/\"__type\"\:\"[\w+\.?]+\"\,/g, "").replace(/<script/gi, "").replace(/script>/gi, "")), t }, e.prototype.GetRequestData = function () { var e = null, t = this, n = this.XHttp; if (t.isRequestReady() && (200 == n.status || 204 == n.status) && !Is.NullOrEmpty(n.responseText)) { e = n.responseText; try { e = JSON.parse(e), e.d && (e = e.d), t.convertProperties(e) } catch (r) { e = null, window.Exception(r) } } return e }, e.prototype.convertProperties = function (e) { var t, n = this; if (Is.Array(e)) for (var r = 0; r < e.length; r++) { var o = e[r]; if (o) { try { t = t ? t : n.getKeyMap(o) } catch (i) { window.Exception(i) } n.setValues(o, t) } for (var a in o) n.convertProperties(o[a]) } else if (e && "object" == typeof e) { t = n.getKeyMap(e), n.setValues(e, t); for (var a in e) n.convertProperties(e[a]) } }, e.prototype.getKeyMap = function (e) { var t = new Array; for (var n in e) { var r = e[n]; r && "string" == typeof r && (r = r.Trim(), 0 == r.indexOf("/Date(") || 0 == r.indexOf("Date(") ? t.push({ Key: n, Type: "Date" }) : r.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/i) ? t.push({ Key: n, Type: "UTCDate" }) : r.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/g) && t.push({ Key: n, Type: "ZDate" })) } return t }, e.prototype.setValues = function (e, t) { for (var n = 0; n < t.length; n++) { var r = t[n].Key, o = t[n].Type, i = e[r]; switch (o) { case "Date": i ? (i = parseInt(i.substring(6).replace(")/", "")), i > -621355752e5 ? (i = new Date(i), e[r] = i) : delete e[r]) : e[r] = new Date; break; case "UTCDate": case "ZDate": var a = new Date(i); if (this.UseAsDateUTC) a = new Date(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate()); else if (window.chrome) { var s = (new Date).getTimezoneOffset(); a = a.Add(0, 0, 0, 0, s) } e[r] = a } } }, e.prototype.Get = function (e, t) { void 0 === t && (t = null), this.Submit("GET", e, t) }, e.prototype.Put = function (e, t) { void 0 === t && (t = null), this.Submit("PUT", e, t) }, e.prototype.Post = function (e, t) { void 0 === t && (t = null), this.Submit("POST", e, t) }, e.prototype.Delete = function (e, t) { void 0 === t && (t = null), this.Submit("DELETE", e, t) }, e.prototype.AddListener = function (e, t) { this.eventHandlers.Add(new Listener(e, t)) }, e.prototype.RemoveListener = function (e, t) { this.eventHandlers.Remove(function (n) { return n.EventType === e && t === t }) }, e.prototype.RemoveListeners = function (e) { this.eventHandlers.Remove(function (t) { return t.EventType === e }) }, e.prototype.Dispatch = function (e) { var t = this, n = this.eventHandlers.Where(function (t) { return t.EventType === e || t.EventType === EventType.Any }); n.forEach(function (n) { return n.EventHandler(new CustomEventArg(t, e)) }) }, e }(), Binder = function () { function e() { this.PrimaryKeys = new Array, this.eventHandlers = new Array, this.DataObjects = new Array, this.AutomaticUpdate = !0, this.AutomaticSelect = !0, this.DataRowTemplates = new Array, this.IsFormBinding = !1 } return e.prototype.WebApiGetParameters = function () { return null }, e.prototype.Dispose = function () { var e = this, t = e.DataObject; e.PrimaryKeys = null, e.WebApi = null, t && (t.RemoveObjectStateListener(), t.RemovePropertyListeners()), e.DataObjects.forEach(function (e) { e.RemoveObjectStateListener(), e.RemovePropertyListeners() }), e.RemoveListeners() }, e.prototype.Execute = function (e) { void 0 === e && (e = null); var t = this; if (t.AutomaticSelect && !Is.NullOrEmpty(t.WebApi)) { var n = t.WebApiGetParameters() ? t.WebApiGetParameters() : e.Parameters, r = new Ajax, o = t.WebApi; r.AddListener(EventType.Completed, t.OnAjaxComplete.bind(this)), n && (o += o.lastIndexOf("/") + 1 == o.length ? "" : "/", o += Is.Array(n) ? n.join("/") : n), r.Get(o) } else t.Dispatch(EventType.Completed) }, e.prototype.OnAjaxComplete = function (e) { var t = this; if (e.EventType === EventType.Completed) { var n = e.Sender.GetRequestData(); n && (Is.Array(n) ? n.forEach(function (e) { return t.Add(t.NewObject(e)) }) : (t.IsFormBinding = !0, t.Bind(t.NewObject(n))), t.Dispatch(EventType.Completed)) } }, e.prototype.Delete = function (e, t) { void 0 === t && (t = null); var n = e.DataObject, r = this; if (!n) for (var o = e.parentElement; !n || o !== r.Element;) n = o.DataObject, o = o.parentElement; if (n) { var i = new Ajax, a = function () { var e = r.Element.Get(function (e) { return e.DataObject === n }); e.forEach(function (e) { return e.parentElement.removeChild(e) }) }, s = function (e) { var n = function () { if (e.EventType === EventType.Error) throw "Failed to delete row." }; t ? t(e) : n(), e.EventType === EventType.Completed ? a() : null }, u = function () { i.AddListener(EventType.Any, s), i.Delete(r.WebApi, n) }; r.AutomaticUpdate ? u() : a() } }, e.prototype.Add = function (e) { var t = this; t.prepTemplates(), t.DataRowTemplates.forEach(function (n) { var r = n.CreateElementFromHtml(), o = r.Get(function (e) { return e.HasDataSet() }), i = t.DataRowFooter; o.Add(r), i ? t.Element.insertBefore(r, i) : t.Element.appendChild(r), t.DataObjects.Add(e), t.Bind(e, o) }) }, e.prototype.prepTemplates = function () { var e = this; if (0 == e.DataRowTemplates.length) { for (var t = e.Element.children, n = new Array, r = 0, o = 0; o < t.length; o++) null != t[o].getAttribute("data-template") && (n.Add(t[o]), r = o); t[t.length - 1] != n[n.length - 1] && (e.DataRowFooter = t[t.length - 1]), n.forEach(function (t) { e.DataRowTemplates.Add(t.outerHTML), t.parentElement.removeChild(t) }) } }, e.prototype.objStateChanged = function (e) { var t = this; if (t.AutomaticUpdate && t.WebApi) { var n = new Ajax; n.AddListener(EventType.Completed, t.OnUpdateComplete.bind(this)), n.Put(t.WebApi, e.ServerObject), e.ObjectState = ObjectState.Clean } }, e.prototype.OnUpdateComplete = function (e) { var t = this, n = e.Sender.GetRequestData(), r = t.DataObject ? t.DataObject : t.DataObjects.First(function (e) { return t.isPKMatch(e, n) }); r ? t.SetServerObjectValue(r, n) : null }, e.prototype.SetServerObjectValue = function (e, t) { for (var n in t) this.PrimaryKeys.First(function (e) { return e === n }) || e.SetServerProperty(n, t[n]) }, e.prototype.isPKMatch = function (e, t) { for (var n = this, r = 0; r < n.PrimaryKeys.length; r++) if (e.ServerObject[n.PrimaryKeys[r]] != t[n.PrimaryKeys[r]]) return !1; return !0 }, e.prototype.Bind = function (e, t) { void 0 === t && (t = null); var n = this; t || (t = n.Element.Get(function (e) { return e.HasDataSet() }), t.Add(n.Element)), n.IsFormBinding && (n.DataObject = e), e.AddObjectStateListener(n.objStateChanged.bind(this)), t.forEach(function (t) { t.DataObject = e, n.setListeners(t, e) }), e.AllPropertiesChanged() }, e.prototype.setListeners = function (e, t) { var n = e.GetDataSetAttributes(), r = this; if ("SELECT" === e.tagName) { var o = n.First(function (e) { return "datasource" == e.Attribute }), i = n.First(function (e) { return "displaymember" == e.Attribute }), a = n.First(function (e) { return "valuemember" == e.Attribute }); if (o) { var s = new Function("return " + o.Property), u = s(); e.AddOptions(u, a ? a.Property : null, i ? i.Property : null) } } var c = ["binder", "datasource", "displaymember", "valuemember"]; n.forEach(function (n) { if (!c.First(function (e) { return e === n.Attribute })) { var o = r.getAttribute(n.Attribute); r.setObjPropListener(n.Property, o, e, t); var i = "checked" === n.Attribute && "checkbox" === e.type ? "checked" : "value" === n.Attribute ? "value" : null; if (i) { var a = function (r) { t.OnElementChanged.bind(t)(e[i], n.Property) }; e.addEventListener("change", a) } } }) }, e.prototype.getAttribute = function (e) { switch (e = e.toLowerCase()) { case "class": case "classname": return "className"; case "innerhtml": return "innerHTML"; case "readonly": return "readOnly"; default: return e } }, e.prototype.setObjPropListener = function (e, t, n, r) { var o = this, i = function (e, t) { if (Has.Properties(n, e)) if ("INPUT" === n.tagName && "radio" === n.type) { var r = n.parentElement.Get(function (e) { return e.name === n.name && "radio" === e.type }); r.forEach(function (e) { return e.checked = !1 }); var i = r.First(function (e) { return e.value === t.toString() }); i ? i.checked = !0 : null } else "className" === e ? (n.className = null, n.className = t) : n[e] = t; else { var a = o.getStyle(e); a ? n.style[a] = t : n[e] = t } }; r.AddPropertyListener(e, t, i) }, e.prototype.getStyle = function (e) { for (var t in document.body.style) if (t.toLowerCase() === e.toLowerCase()) return t; return null }, Object.defineProperty(e.prototype, "SelectedObject", { get: function () { return this.selectedObject }, set: function (e) { this.selectedObject = e }, enumerable: !0, configurable: !0 }), e.prototype.AddListener = function (e, t) { var n = this.eventHandlers.First(function (n) { return n.EventType === e && n.EventHandler === t }); n || this.eventHandlers.Add(new Listener(e, t)) }, e.prototype.RemoveListener = function (e, t) { this.eventHandlers.Remove(function (n) { return n.EventType === e && t === t }) }, e.prototype.RemoveListeners = function (e) { void 0 === e && (e = EventType.Any), this.eventHandlers.Remove(function (t) { return e === EventType.Any || t.EventType === e }) }, e.prototype.Dispatch = function (e) { var t = this, n = this.eventHandlers.Where(function (t) { return t.EventType === e }); n.forEach(function (n) { return n.EventHandler(new CustomEventArg(t, e)) }) }, e }(), __extends = this && this.__extends || function (e, t) { function n() { this.constructor = e } for (var r in t) t.hasOwnProperty(r) && (e[r] = t[r]); e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n) }, DataObject = function () { function e(e) { void 0 === e && (e = null), this.changeCount = 0, this.changeQueued = !1, this.eLstenrs = new Array, this.oLstenrs = new Array, this.objectState = ObjectState.Clean, this.serverObject = e, this.objectState = ObjectState.Clean } return Object.defineProperty(e.prototype, "ObjectState", { get: function () { return this.objectState }, set: function (e) { var t = this; t.objectState = e, e === ObjectState.Dirty && t.OnObjectStateChanged() }, enumerable: !0, configurable: !0 }), e.prototype.AddPropertyListener = function (e, t, n) { this.eLstenrs.Add(new PropertyListener(e, t, n)) }, e.prototype.RemovePropertyListeners = function () { this.eLstenrs.Remove(function (e) { return !0 }) }, e.prototype.OnPropertyChanged = function (e) { var t = this, n = this.eLstenrs.Where(function (t) { return t.PropertyName === e }); n.forEach(function (n) { return n.Handler(n.Attribute, t[e]) }) }, e.prototype.AllPropertiesChanged = function () { var e = this; this.eLstenrs.forEach(function (t) { return t.Handler(t.Attribute, e[t.PropertyName]) }) }, e.prototype.InstigatePropertyChangedListeners = function (e, t) { void 0 === t && (t = !0), this.OnPropertyChanged(e), t && this.ObjectState != ObjectState.Cleaning && (this.ObjectState = ObjectState.Dirty) }, e.prototype.AddObjectStateListener = function (e) { this.oLstenrs.Add(e) }, e.prototype.RemoveObjectStateListener = function () { this.oLstenrs.Remove(function (e) { return !0 }) }, e.prototype.OnObjectStateChanged = function () { var e = this; this.oLstenrs.forEach(function (t) { return t(e) }) }, e.prototype.OnElementChanged = function (e, t) { this[t] = e }, Object.defineProperty(e.prototype, "ServerObject", { get: function () { return this.serverObject }, set: function (e) { this.serverObject = e }, enumerable: !0, configurable: !0 }), e.prototype.SetServerProperty = function (e, t) { var n = this, r = t != n.ServerObject[e]; n.ServerObject[e] = t, r && this.InstigatePropertyChangedListeners(e, !0) }, e }(), DynamicDataObject = function (e) { function t(t) { var n = t; e.call(this, n); for (var r in n) this.setProps(r, n) } return __extends(t, e), t.prototype.setProps = function (e, t) { var n = this, r = function () { return t[e] }, o = function (t) { n.SetServerProperty(e, t) }, i = Object.defineProperty; i ? i(n, e, { get: r, set: o }) : null }, t }(DataObject), CacheStrategy; !function (e) { e[e.ViewAndData = 0] = "ViewAndData", e[e.View = 1] = "View", e[e.Data = 2] = "Data" }(CacheStrategy || (CacheStrategy = {})); var View = function () { function e() { this.eHandlrs = new Array, this.preload = null } return Object.defineProperty(e.prototype, "Preload", { get: function () { return this.preload }, set: function (e) { this.preload = e }, enumerable: !0, configurable: !0 }), e.prototype.Cache = function (e) { void 0 === e && (e = CacheStrategy.ViewAndData); var t = this; !t.Preload || e !== CacheStrategy.ViewAndData && e !== CacheStrategy.Data || t.Preload.Execute(function () { }); var n = sessionStorage.getItem(t.ViewUrl()); if (!n && (e === CacheStrategy.View || e === CacheStrategy.ViewAndData)) { var r = new Ajax; r.AddListener(EventType.Completed, function (e) { t.RequestCompleted(e, !0) }), r.Get(t.ViewUrl()) } }, e.prototype.Show = function (e) { var t = this; t.ViewInstance = e, t.Preload ? t.Preload.Execute(t.postPreloaded.bind(this)) : t.postPreloaded() }, e.prototype.postPreloaded = function () { var e = this, t = sessionStorage.getItem(e.ViewUrl()); if (!t || window.IsDebug) { var n = new Ajax; n.AddListener(EventType.Completed, e.RequestCompleted.bind(this)), n.Get(e.ViewUrl()) } else e.SetHTML(t) }, e.prototype.RequestCompleted = function (e, t) { void 0 === t && (t = !1), e.Sender.ResponseText && (sessionStorage.setItem(this.ViewUrl(), e.Sender.ResponseText), t || this.SetHTML(e.Sender.ResponseText)), e.Sender = null }, e.prototype.SetHTML = function (e) { var t = this, n = this, r = n.ContainerID().Element(); if (Is.NullOrEmpty(r)) n.Dispatch(EventType.Completed); else { n.cached = "div".CreateElement({ innerHTML: e }); var o = n.cached.Get(function (e) { return !Is.NullOrEmpty(e.getAttribute("data-binder")) }); n.countBindersReported = 0, n.countBinders = 0, o.length > 0 ? (o.forEach(function (e) { try { var r = e.getAttribute("data-binder"); if (r) { var o = new Function("return new " + r + "()"); e.Binder = o(), e.Binder.AddListener(EventType.Completed, n.OnBinderComplete.bind(t)), e.Binder.Element = e, n.countBinders = n.countBinders + 1 } } catch (e) { window.Exception(e) } }), o.forEach(function (e) { if (e.Binder) try { e.Binder.Execute(n.ViewInstance) } catch (t) { window.Exception(e) } })) : n.MoveStuffFromCacheToReal() } }, e.prototype.OnBinderComplete = function (e) { var t = this; e.EventType === EventType.Completed && (t.countBindersReported = t.countBindersReported + 1, t.countBinders === t.countBindersReported && t.MoveStuffFromCacheToReal()) }, e.prototype.MoveStuffFromCacheToReal = function () { var e = this, t = e.ContainerID().Element(), n = t.Get(function (e) { return null != e.Binder }); for (n.forEach(function (e) { return e.Binder.Dispose() }), t.Clear() ; e.cached.childNodes.length > 0;) { var r = e.cached.childNodes[0]; e.cached.removeChild(r), t.appendChild(r) } e.Dispatch(EventType.Completed) }, e.prototype.AddListener = function (e, t) { var n = this, r = n.eHandlrs.First(function (n) { return n.EventType === e && n.EventHandler === t }); r || n.eHandlrs.Add(new Listener(e, t)) }, e.prototype.RemoveListener = function (e, t) { this.eHandlrs.Remove(function (n) { return n.EventType === e && t === t }) }, e.prototype.RemoveListeners = function (e) { this.eHandlrs.Remove(function (t) { return t.EventType === e }) }, e.prototype.Dispatch = function (e) { var t = this, n = this.eHandlrs.Where(function (t) { return t.EventType === e }); n.forEach(function (n) { return n.EventHandler(new CustomEventArg(t, e)) }) }, e }(), DataLoaders = function () { function e() { for (var e = [], t = 0; t < arguments.length; t++) e[t - 0] = arguments[t]; this.completedCount = 0, this._dataLoaders = e } return e.prototype.Execute = function (e) { var t = this, n = this; n._callback = e, n.completedCount = 0, n._dataLoaders.forEach(function (e) { return e.Execute(n.Completed.bind(t)) }) }, e.prototype.Completed = function () { var e = this; e.completedCount++, e.completedCount === e._dataLoaders.length && e._callback() }, e }(), DataLoader = function () { function e(e, t, n, r) { void 0 === n && (n = null), void 0 === r && (r = null), this._parameters = null; var o = this; o._dataCallBack = t, o._dataUrl = e, o._shouldTryLoad = n } return e.prototype.Execute = function (e) { var t = this; if (t._completed = e, !t._shouldTryLoad || t._shouldTryLoad()) { var n = new Ajax; n.AddListener(EventType.Completed, t._ajaxCompleted.bind(this)), n.Get(t._dataUrl, t._parameters) } else t._completed() }, e.prototype._ajaxCompleted = function (e) { this._dataCallBack(e), this._completed() }, e }(), ViewContainers = new Array, ViewContainer = function () { function e() { this.Views = new Array, this.IsDefault = !1 } return e.prototype.Show = function (e) { var t = this; this.NumberViewsShown = 0, ProgressManager.Show(), this.Views.forEach(function (n) { n.AddListener(EventType.Completed, t.ViewLoadCompleted.bind(t)), n.Show(e) }) }, e.prototype.IsUrlPatternMatch = function (e) { var t = this.UrlPattern(); if (t) { var n = new RegExp(t, "i"); return e.match(n) ? !0 : !1 } return !1 }, e.prototype.ViewLoadCompleted = function (e) { e.EventType === EventType.Completed && (this.NumberViewsShown = this.NumberViewsShown + 1), this.NumberViewsShown === this.Views.length && ProgressManager.Hide() }, e }(), ViewInstance = function () { function e(e, t) { this.Parameters = e, this.ViewContainer = t } return e }(), EventType; !function (e) { e[e.Any = 0] = "Any", e[e.Completed = 1] = "Completed", e[e.Error = 2] = "Error", e[e.Aborted = 3] = "Aborted", e[e.Message = 4] = "Message" }(EventType || (EventType = {})); var CustomEventArg = function () { function e(e, t) { this.Cancel = !1, this.Sender = e, this.EventType = t } return e }(), Listener = function () { function e(e, t) { this.EventType = e, this.EventHandler = t } return e }(), PropertyListener = function () { function e(e, t, n) { this.PropertyName = e, this.Attribute = t, this.Handler = n } return e }(), ObjectState; !function (e) { e[e.Dirty = 0] = "Dirty", e[e.Cleaning = 1] = "Cleaning", e[e.Clean = 2] = "Clean" }(ObjectState || (ObjectState = {})); var HistoryContainer; !function (e) { var t = function () { function e() { this.ViewInstances = new Array } return e.prototype.CurrentRoute = function () { var e = this.ViewInstances; return null != e && e.length > 0 ? e[e.length - 1] : null }, e.prototype.BackEvent = function (e) { HistoryManager.Back() }, e.prototype.Add = function (e) { this.ViewInstances.Add(e), this.ManageRouteInfo(e) }, e.prototype.Back = function () { var e = this.ViewInstances; if (e.length > 1 && e.splice(e.length - 1, 1), e.length > 0) { var t = e[e.length - 1], n = t.ViewContainer; n.Show(t), this.ManageRouteInfo(t) } }, e.prototype.ManageRouteInfo = function (e) { var t = e, n = t.ViewContainer, r = n.UrlTitle(t), o = n.DocumentTitle(t), i = history, a = n.Url(t); a && !Is.NullOrEmpty(r) && i && i.pushState && (a = this.FormatUrl(Is.NullOrEmpty(a) ? "/" : 0 != a.indexOf("/") ? "/" + a : a), i.pushState(null, r, a)), o && (document.title = o) }, e.prototype.FormatUrl = function (e) { return e = e.replace(/[^A-z0-9\/]/g, "") }, e }(); e.History = t }(HistoryContainer || (HistoryContainer = {})); var HistoryManager = new HistoryContainer.History, Initializer; !function (e) { function t(e) { var t = window; if ("complete" === document.readyState) n(); else if (t.onload) { var r = t.onload, o = function () { r(e), n() }; t.onload = o } else t.onload = function () { n() } } function n() { var e = window; r(), a(), e.ShowByUrl(e.location.pathname.substring(1)), e.addEventListener("popstate", HistoryManager.BackEvent) } function r() { var e = s(), t = window; for (var n in t) { var r = o(i(t[n]), e); if (!Is.NullOrEmpty(r)) try { var a = new Function("return new " + r + "();")(); Has.Properties(a, "IsDefault", "Views", "Show", "Url", "UrlPattern", "UrlTitle", "IsUrlPatternMatch") && ViewContainers.Add(a) } catch (u) { t.Exception(u) } } } function o(e, t) { var n = e; if (!Is.NullOrEmpty(n)) { var r = "^function\\s(\\w+)\\(\\)", o = n.match(r); if (o && !t.First(function (e) { return e === o[1] })) return o[1] } return null } function i(e) { return e && e.toString ? e.toString() : null } function a() { var e = document.getElementById("progress"); null != e && (ProgressManager.ProgressElement = e) } function s() { return ["Ajax", "Binder", "DataObject", "View", "ViewContainer", "ViewContainers", "ViewInstance", "EventType", "CustomEventArg", "Listener", "PropertyListener", "ObjectState", "HistoryManager", "Initializer", "Is", "ProgressManager"] } e.WindowLoad = t }(Initializer || (Initializer = {})), Initializer.WindowLoad(); var Is; !function (e) { function t(e) { return "[object Array]" === Object.prototype.toString.call(e) } function n(e) { return null == e || e.length && 0 === e.length } e.Array = t, e.NullOrEmpty = n }(Is || (Is = {})); var Has; !function (e) { function t(e) { for (var t = [], n = 1; n < arguments.length; n++) t[n - 1] = arguments[n]; for (var r = t, o = 0; o < r.length; o++) if (void 0 === e[r[o]]) return !1; return !0 } e.Properties = t }(Has || (Has = {})); var ProgressManager; !function (e) { function t() { var t = e.ProgressElement; t && (t.style.display = "inline") } function n() { var t = e.ProgressElement; t && (t.style.display = "none") } e.ProgressElement = null, e.Show = t, e.Hide = n }(ProgressManager || (ProgressManager = {})), Array.prototype.Add = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t - 0] = arguments[t]; var n = e; Is.Array(n) || (n = [n]); for (var r = 0; r < n.length; r++) this.push(n[r]) }, Array.prototype.First = function (e) { var t = this, n = t.length; if (e) { for (var r = 0; n > r; r++) if (e(t[r])) return t[r] } else if (n > 0) return t[0]; return null }, Array.prototype.Last = function (e) { var t = this, n = t.length; if (e) for (var r = n - 1; r > 0;) { if (e(t[r])) return t[r]; r-- } return n > 0 ? t[n - 1] : null }, Array.prototype.Remove = function (e) { var t = this; if (e) for (var n = t.length - 1; n > 0;) e(t[n]) && t.splice(n, 1), n--; return t }, Array.prototype.Where = function (e) { for (var t = new Array, n = 0; n < this.length; n++) { var r = this[n]; e(r) && t.push(r) } return t }, Date.prototype.Add = function (e, t, n, r, o, i) { e = e ? e : 0, t = t ? t : 0, n = n ? n : 0, r = r ? r : 0, o = o ? o : 0, i = i ? i : 0; var a = this; return new Date(a.getFullYear() + e, a.getMonth() + t, a.getDate() + n, a.getHours() + r, a.getMinutes() + o, a.getSeconds() + i, a.getMilliseconds()) }, HTMLElement.prototype.Get = function (e, t, n) { for (var r = null == n ? new Array : n, o = this.children, i = 0; i < o.length; i++) { var a = o[i]; 1 == a.nodeType && "svg" != a.tagName.toLowerCase() && (e(a) && r.push(a), !t && a.Get && a.Get(e, t, r)) } return r }, HTMLElement.prototype.First = function (e) { for (var t = this.children, n = 0; n < t.length; n++) { var r = t[n]; if (1 == r.nodeType && "svg" != r.tagName.toLowerCase() && e(r)) return r } for (var n = 0; n < t.length; n++) { var r = t[n]; if (1 == r.nodeType && "svg" != r.tagName.toLowerCase() && r.First) { var o = r.First(e); if (o) return o } } return null }, HTMLElement.prototype.Clear = function () { for (var e = this, t = e.childNodes; t.length > 0;) e.removeChild(t[0]) }, HTMLElement.prototype.AddListener = function (e, t) { this.addEventListener ? this.addEventListener(e, t) : this.attachEvent(e, t) }, HTMLElement.prototype.Set = function (e) { var t = this, n = e; if (n) for (var r in n) "cls" != r && "className" != r ? r.IsStyle() ? t.style[r] = n[r] : "style" === r ? n.style.cssText && (t.style.cssText = n.style.cssText) : t[r] = n[r] : (t.className = null, t.className = n[r]); return t }, HTMLElement.prototype.HasDataSet = function () { var e = this.dataset; if (e) for (var t in e) return !0; return !1 }, HTMLElement.prototype.GetDataSetAttributes = function () { var e = new Array, t = this.dataset; if (t) for (var n in t) e.Add({ Attribute: n, Property: t[n] }); return e }, HTMLElement.prototype.DeleteFromServer = function () { for (var e = this.parentElement; !e.Binder && (e = e.parentElement, e !== document.body) ;); e && e.Binder && e.Binder.Delete(this) }, HTMLSelectElement.prototype.AddOptions = function (e, t, n, r) { var o = this, i = r, a = e, s = function (e, t) { var n = new Option(e, t); o.options[o.options.length] = n, i && t === i && (n.selected = !0) }; if (Is.Array(a)) { var u = a, c = n, p = t; c && p ? u.forEach(function (e) { s(e[c], e[p]) }) : u.length > 1 && "string" == typeof u[0] && u.forEach(function (e) { s(e, e) }) } else if (a) for (var l in a) a[l] && "[object Function]" === {}.toString.call(a[l]) || s(a[l], a[l]); return o }, String.prototype.Trim = function () { return this.replace(/^\s+|\s+$/g, "") }, String.prototype.Element = function () { var e = document.getElementById(this.toString()); return e ? e : null }, String.prototype.CreateElement = function (e) { var t = document.createElement(this), n = e; return n && t.Set(n), t }, String.prototype.CreateElementFromHtml = function () { for (var e = "div".CreateElement({ innerHTML: this }), t = e.children; t.length > 0;) { var n = t[t.length - 1]; return n } }, String.prototype.IsStyle = function () { for (var e in document.body.style) if (e.toLowerCase() === this.toLowerCase()) return !0; return !1 }, Window.prototype.Exception = function () { for (var e = [], t = 0; t < arguments.length; t++) e[t - 0] = arguments[t]; if (1 == e.length) { for (var n = {}, r = 0; r < e.length; r++) n["parameter" + r] = e[r]; alert(JSON.stringify(n)) } else e.length > 1 ? alert(JSON.stringify(e[0])) : alert("Unknown error") }, Window.prototype.Show = function (e, t) { var n = new e, r = new ViewInstance(t, n); n.Show(r), HistoryManager.Add(r) }, Window.prototype.ShowByUrl = function (e) { var t = ViewContainers.First(function (t) { return t.IsUrlPatternMatch(e) }); if (t = null == t ? ViewContainers.First(function (e) { return e.IsDefault }) : t) { var n = e.split("/"), r = new ViewInstance(n, t); t.Show(r), HistoryManager.Add(r) } };