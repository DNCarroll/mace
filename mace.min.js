var Ajax=function(){function n(n,t){n===void 0&&(n=!1);t===void 0&&(t=null);this.DisableElement=null;this.WithProgress=!1;this.UseAsDateUTC=!1;this.ContentType="application/json; charset=utf-8";this.eventHandlers=[];this.WithProgress=n;this.DisableElement=t}return Object.defineProperty(n.prototype,"ResponseText",{get:function(){return this.XHttp.responseText},enumerable:!0,configurable:!0}),n.prototype.Submit=function(n,t,i,r){var u,f,e;i===void 0&&(i=null);r===void 0&&(r=!1);u=this;u.Progress();t=u.getUrl(t);u.XHttp=new XMLHttpRequest;f=u.XHttp;f.addEventListener("readystatechange",u.xStateChanged.bind(u),!1);f.open(n,t,!0);u.setHead();try{e=r?i:u.getParameters(i);Is.NullOrEmpty(e)?f.send():f.send(e)}catch(o){u.Progress(!1);window.Exception(o)}},n.prototype.xStateChanged=function(){var n=this,i=n.XHttp,t=i.status;n.isRequestReady()&&(n.Progress(!1),n.Dispatch(t===200||t===204||t===201?EventType.Completed:EventType.Any))},n.prototype.getUrl=function(t){var i=t,r=n.Host;return i.indexOf("http")==-1&&r&&(i=r+(i.indexOf("/")==0?i:"/"+i)),i},n.prototype.isRequestReady=function(){var n=this.XHttp;return n&&n.readyState==4},n.prototype.Progress=function(n){var r,i;if(n===void 0&&(n=!0),this.WithProgress){r=ProgressManager;n?r.Show():r.Hide();var t=this.DisableElement,u="disabled",f=function(t){n?t.setAttribute(u,u):t.removeAttribute(u)};if(t)if(Is.Array(t))for(i=0;i<t.length;i++)f(t[i]);else f(t)}},n.prototype.setHead=function(){var i=this,f=i.XHttp,r,u,t;if(i.ContentType&&f.setRequestHeader("content-type",i.ContentType),i.Header&&(r=i.Header(),r))for(t in r)f.setRequestHeader(t,r[t]);if(n.GlobalHeader&&(u=n.GlobalHeader(),u))for(t in u)f.setRequestHeader(t,u[t])},n.prototype.getParameters=function(n){var i="",t=n;return t&&this.ContentType==="application/json; charset=utf-8"&&(t=DataObject.IsDataObject(t)?t.ServerObject:t,i=JSON.stringify(t).replace(/\\\"__type\\\"\:\\\"[\w+\.?]+\\\"\,/g,"").replace(/\"__type\"\:\"[\w+\.?]+\"\,/g,"").replace(/<script/ig,"").replace(/script>/ig,"")),i},n.prototype.GetRequestData=function(){var n=null,i=this,t=this.XHttp,r=t.status;if(i.isRequestReady()&&r==200&&!Is.NullOrEmpty(t.responseText)){n=t.responseText;try{n=JSON.parse(n);n.d&&(n=n.d);i.convertProperties(n)}catch(u){n=null;window.Exception(u)}}return n},n.prototype.convertProperties=function(n){var t,i=this,u,r,f;if(Is.Array(n))for(u=0;u<n.length;u++){if(r=n[u],r){try{t=t?t:i.getKeyMap(r)}catch(e){window.Exception(e)}i.setValues(r,t)}for(f in r)i.convertProperties(r[f])}else if(n&&typeof n=="object"){t=i.getKeyMap(n);i.setValues(n,t);for(f in n)i.convertProperties(n[f])}},n.prototype.getKeyMap=function(n){var r=[],i,t;for(i in n)t=n[i],t&&typeof t=="string"&&(t=t.Trim(),t.indexOf("/Date(")==0||t.indexOf("Date(")==0?r.push({Key:i,Type:"Date"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/i)?r.push({Key:i,Type:"UTCDate"}):t.match(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/g)&&r.push({Key:i,Type:"ZDate"}));return r},n.prototype.setValues=function(n,t){for(var r,e,u=0;u<t.length;u++){var f=t[u].Key,o=t[u].Type,i=n[f];switch(o){case"Date":i?(i=parseInt(i.substring(6).replace(")/","")),i>-621355752e5?(i=new Date(i),n[f]=i):delete n[f]):n[f]=new Date;break;case"UTCDate":case"ZDate":r=new Date(i);this.UseAsDateUTC?r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()):window.chrome&&(e=(new Date).getTimezoneOffset(),r=r.Add(0,0,0,0,e));n[f]=r}}},n.prototype.Get=function(n,t){t===void 0&&(t=null);this.Submit("GET",n,t)},n.prototype.Put=function(n,t){t===void 0&&(t=null);this.Submit("PUT",n,t)},n.prototype.Post=function(n,t){t===void 0&&(t=null);this.Submit("POST",n,t)},n.prototype.Delete=function(n,t){t===void 0&&(t=null);this.Submit("DELETE",n,t)},n.prototype.AddListener=function(n,t){this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eventHandlers.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n||t.EventType===EventType.Any});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),Binder=function(){function n(n,t,i,r,u){n===void 0&&(n=null);t===void 0&&(t=null);i===void 0&&(i=!1);r===void 0&&(r=null);u===void 0&&(u=null);this._api=null;this.PrimaryKeys=[];this.WithProgress=!0;this.eventHandlers=[];this.DataObjects=new DataObjectCacheArray;this.AutomaticUpdate=!0;this.AutomaticDelete=!0;this.AutomaticSelect=!0;this.DataRowTemplates=[];this.initialLoad=!0;this.FormTemplates=[];this.RunWhenObjectsChange=null;var e=n,f=this;f.StaticProperties=u;f.PrimaryKeys=e?e:f.PrimaryKeys;f.AutomaticUpdate=i;r&&(f.NewObject=function(n){return DataObject.IsDataObject(n)?n:new r(n)});f._api=t}return n.prototype.ApiPrefix=function(){return"/Api/"},n.prototype.Api=function(){var n=this,i,t;return n._api||(i=Reflection,t=i.GetName(n.constructor),t=t.replace("Binder",""),n._api=n.ApiPrefix()+t),n._api},n.prototype.NewObject=function(n){return DataObject.IsDataObject(n)?n:new DataObject(n,null,this.StaticProperties)},n.prototype.Dispose=function(){var n=this;n.PrimaryKeys=null;n.Api=null;n.DataObjects.forEach(function(n){n.RemoveObjectStateListener();n.RemovePropertyListeners()});n.RemoveListeners()},n.prototype.GetApiForAjax=function(n){var t=this.Api(),u,o;if(t){t=t.indexOf("/")===0?t.substring(1):t;var r=t.split("/"),s=r.Where(function(n){return n.indexOf("?")>-1}),f=n?n.Where(function(n){return r.First(function(t){return t===n})===null}):[],i=[],e=0;for(u=0;u<r.length;u++)o=r[u],o.indexOf("?")>-1?(f.length>e&&i.Add(f[e]),e++):i.Add(o);return s&&s.length===0?f.forEach(function(n){return i.Add(n)}):null,(i[0].indexOf("http")==-1?"/":"")+i.join("/")}return null},n.prototype.Execute=function(n){n===void 0&&(n=null);var t=this;t.prepTemplates();try{t.DataObjects.length>0&&t.initialLoad?(t.SetUpMore(t.DataObjects.Data),t.DataObjects.forEach(function(n){t.add(n,!0)}),t.Dispatch(EventType.Completed)):t.AutomaticSelect&&!Is.NullOrEmpty(t.Api)?t.loadFromVI(n):t.Dispatch(EventType.Completed)}catch(i){alert("Failed to load data.")}t.initialLoad=!1},n.prototype.Refresh=function(n){n===void 0&&(n=null);var t=n?n:HistoryManager.CurrentViewInstance();t.RefreshBinding=!0;this.loadFromVI(n)},n.prototype.loadFromVI=function(n){var t=this,i,r;t.prepTemplates();n=Is.Alive(n)?n:HistoryManager.CurrentViewInstance();n.RefreshBinding&&(t.DataObjects=new DataObjectCacheArray,t.Element.ClearBoundElements());i=new Ajax(t.WithProgress,t.DisableElement);r=t.GetApiForAjax(n.Parameters);Is.NullOrEmpty(r)?t.Dispatch(EventType.Completed):(i.AddListener(EventType.Any,t.OnAjaxComplete.bind(this)),i.Get(r))},n.prototype.OnAjaxComplete=function(n){var i=this,r=n.Sender.XHttp,u=r.status,t;i.isRedirecting(r)||(u===200&&(t=n.Sender.GetRequestData(),t&&this.RouteBinding(t)),i.Dispatch(EventType.Completed))},n.prototype.RouteBinding=function(n){var t=this,i=n,f=t.DataObjects,u,r;Is.Array(i)?(i.forEach(function(n){return t.add(t.NewObject(n))}),t.DataObjects.length>0&&t.ResetSelectedObject()):i&&(u=t.NewObject(i),f.Data.Add(u),t.Bind(u));t.SetUpMore(i);f.SaveCache();r=HistoryManager.CurrentViewInstance();r&&r.RefreshBinding&&(t.ResetSelectedObject(),r.RefreshBinding=!1);t.Dispatch(EventType.Completed)},n.prototype.SetUpMore=function(n){var i=this,r=i.MoreElement,t="none";r&&(t=n.length>0&&n.length%i.MoreThreshold==0?"inline":t,r.style.display=t)},n.prototype.Delete=function(n,t){var r,i,u;if(t===void 0&&(t=null),r=n.DataObject,i=this,!r)for(u=n.parentElement;!r;)if(r=u.DataObject,u=u.parentElement,u===i.Element)break;if(r){var e=new Ajax(i.WithProgress,i.DisableElement),f=function(){var t=i.Element.Get(function(n){return n.DataObject===r}),n=i.DataObjects.Data,u=n.indexOf(r);t.forEach(function(n){return n.parentElement.removeChild(n)});n.forEach(function(n){return n.InstigatePropertyChangedListeners("AlternatingRowClass",!1)})},o=function(n){var r=function(){var t=n.Sender.XHttp,r=t.status;i.isRedirecting(t)||([204,404,200].indexOf(r)>-1?f():alert("Failed to delete row."))};t?t(n):r();n.EventType===EventType.Completed?f():null},s=function(){e.AddListener(EventType.Any,o);e.Delete(i.Api(),r.ServerObject)};i.AutomaticDelete?s():f()}},n.prototype.InsertBefore=function(n,t){this.add(this.NewObject(n),!1,t)},n.prototype.Append=function(n){this.add(this.NewObject(n))},n.prototype.PostAndAppend=function(n){var t=this,r=n,u=t.Api(),i;DataObject.IsDataObject(n)&&(r=n.ServerObject);u&&(i=new Ajax(t.WithProgress,t.DisableElement),i.AddListener(EventType.Any,t.OnUpdateComplete.bind(this)),i.Post(u,r))},n.prototype.PostAndInsertBefore=function(n,t){var e=this,i=this,u=n,f=i.Api(),o=t,r;DataObject.IsDataObject(n)&&(u=n.ServerObject);f&&(r=new Ajax(i.WithProgress,i.DisableElement),r.AddListener(EventType.Any,function(n){var r=n.Sender.GetRequestData();r&&i.add(e.NewObject(r),!1,t)}),r.Post(f,u))},n.prototype.add=function(n,t,i){t===void 0&&(t=!1);i===void 0&&(i=-1);var r=this,u=r.DataRowTemplates;r.prepTemplates();u.length>0?u.forEach(function(u){var f=u.cloneNode(!0),s=f.Get(function(n){return n.HasDataSet()}),o=r.DataRowFooter,e=r.Element.tagName==="TABLE"?r.Element.tBodies[0]:r.Element;s.Add(f);i>-1&&i<e.childNodes.length&&(o=e.children[i]);o?e.insertBefore(f,o):e.appendChild(f);t||r.DataObjects.Add(n);n.Container=r.DataObjects.Data;f.onclick=function(){r.SelectedObject=n};r.Bind(n,s);i>-1&&(r.SelectedObject=n)}):r.Bind(n,null)},n.prototype.ResetSelectedObject=function(){this.SelectedObject=this.selectedObject},n.prototype.prepTemplates=function(){var n=this,f=n.DataRowTemplates,i;if(f.length===0){var t=n.Element.tagName==="TABLE"?n.Element.tBodies[0].children:n.Element.children,u=[],s=0;for(i=0;i<t.length;i++)t[i].getAttribute("data-template")!=null&&(u.Add(t[i]),s=i);n.DataRowFooter=t[t.length-1]!==u[u.length-1]?t[t.length-1]:null;u.forEach(function(n){f.Add(n);n.parentElement.removeChild(n)});var e="data-morekeys",o="data-morethreshold",r=n.Element.First(function(n){return n.HasDataSet()&&n.getAttribute(e)!=null&&n.getAttribute(o)!=null});r&&(n.MoreElement=r,n.MoreKeys=r.getAttribute(e).split(";"),n.MoreThreshold=parseInt(r.getAttribute(o)),r.onclick=function(){n.More()})}},n.prototype.objStateChanged=function(n){var i=this,t=i.RunWhenObjectsChange;t?t():null;this.AutomaticUpdate?this.Save(n):null},n.prototype.Save=function(n){var r;if(!Is.Alive(t)||!Is.Alive(t.Api)){var t=this,i=n,u=t.Api();u&&i.ObjectState===ObjectState.Dirty&&(r=new Ajax(t.WithProgress,t.DisableElement),r.AddListener(EventType.Any,t.OnUpdateComplete.bind(this)),i.ObjectState=ObjectState.Cleaning,r.Put(u,i.ServerObject))}},n.prototype.OnUpdateComplete=function(n){var t=this,o=n.Sender.XHttp,r=t.DataObjects,e=n.Sender.GetRequestData(),u=Is.Array(e)?e:[e],i,f;if(!t.isRedirecting(o))if(o.status===200)for(i=0;i<u.length;i++)f=r.First(function(n){return t.isPKMatch(n,u[i])}),f?(t.SetServerObjectValue(f,u[i]),f.ObjectState=ObjectState.Clean,r&&r.length>0?r.SaveCache():null):t.add(t.NewObject(u[i]));else alert("Failed to update record.")},n.prototype.SaveDirty=function(){var n=this,u=n.Api(),t=n.DataObjects.Data.Where(function(n){return n.ObjectState===ObjectState.Dirty}),r,i;u&&t&&t.length>0&&(r=t.Select(function(n){return n.ServerObject}),i=new Ajax(n.WithProgress,n.DisableElement),i.AddListener(EventType.Any,n.OnUpdateComplete.bind(this)),i.Submit("PUT",n.Api()+"/SaveDirty",r),t.forEach(function(n){return n.ObjectState=ObjectState.Cleaning}))},n.prototype.isRedirecting=function(n){var t=n.status,i=n.getResponseHeader("Location");return(t===401||t===407||t===403)&&i?(window.location.href=i,!0):!1},n.prototype.SetServerObjectValue=function(n,t){for(var i in t)this.PrimaryKeys.First(function(n){return n===i})?null:n.SetServerProperty(i,t[i])},n.prototype.isPKMatch=function(n,t){var i=this,r;if(i!=null&&i.PrimaryKeys!=null)for(r=0;r<i.PrimaryKeys.length;r++)if(n.ServerObject[i.PrimaryKeys[r]]!=t[i.PrimaryKeys[r]])return!1;return!0},n.prototype.Bind=function(n,t){t===void 0&&(t=null);var i=this;n.Binder=i;t||(t=i.Element.Get(function(n){return n.HasDataSet()}),t.Add(i.Element));n.AddObjectStateListener(i.objStateChanged.bind(this));t.forEach(function(t){t.DataObject=n;i.setListeners(t,n)});n.AllPropertiesChanged()},n.prototype.setListeners=function(n,t){var i=n.GetDataSetAttributes(),f=this,c,l,u,a,r;if(n.tagName==="SELECT"){var e=i.First(function(n){return n.Attribute==="datasource"}),o=i.First(function(n){return n.Attribute==="displaymember"}),s=i.First(function(n){return n.Attribute==="valuemember"}),h=n;e&&h.options.length==0&&(c=new Function("return "+e.Property),l=c(),h.AddOptions(l,s?s.Property:null,o?o.Property:null))}u=["onclick","onchange","onload","loaded"];a=["binder","datasource","displaymember","valuemember"];i.forEach(function(i){var e,o,r,s,h;Autofill.IsAutoFill(n,t)||u.First(function(n){return n===i.Attribute})||a.First(function(n){return n===i.Attribute})||(e=f.getAttribute(i.Attribute),o=n.tagName,f.setObjPropListener(i.Property,e,n,t),["INPUT","SELECT","TEXTAREA"].indexOf(o)>-1&&(r=i.Attribute==="checked"&&n.type==="checkbox"?"checked":n.type==="radio"&&i.Attribute==="checked"?"value":i.Attribute,r&&["value","checked"].indexOf(r)>-1&&(Is.Alive(n.onchange)&&(s=n.onchange,n.removeEventListener("change",s)),h=function(){t.OnElementChanged.bind(t)(n[r],i.Property)},n.addEventListener("change",h))))});r=i.Where(function(n){return u.First(function(t){return t===n.Attribute})!==null});r&&r.length>0&&r.forEach(function(i){var r,u;n.DataObject=t;r=i.Property;r&&(r=r.lastIndexOf(";")===r.length-1?r:r+";",u=new Function("sender",r),i.Attribute==="loaded"?u(n):n[i.Attribute]=function(){u(n);return})})},n.prototype.getAttribute=function(n){n=n.toLowerCase();switch(n){case"class":case"classname":return"className";case"innerhtml":return"innerHTML";case"readonly":return"readOnly";default:return n}},n.prototype.setObjPropListener=function(n,t,i,r){var u=this,f=this,e=function(n,t){var e,o,s;Has.Properties(i,n)&&n!=="width"&&n!=="height"?i.tagName==="INPUT"&&i.type==="radio"&&n==="checked"?(e=u.Element.Get(function(n){return n.DataObject===r&&n.type==="radio"&&n.dataset.checked===i.dataset.checked}),e.forEach(function(n){return n.checked=!1}),o=e.First(function(n){return n.value===t.toString()}),o?o.checked=!0:null):n==="className"?(i.className=null,i.className=t):i[n]=t:(s=f.getStyle(n),s?i.style[s]=t:n==="for"&&i.setAttribute("for",t))};r.AddPropertyListener(n,t,e)},n.prototype.getStyle=function(n){for(var t in document.body.style)if(t.toLowerCase()===n.toLowerCase())return t;return null},Object.defineProperty(n.prototype,"SelectedObject",{get:function(){return this.selectedObject},set:function(n){var t=this,i=t.FormTemplateIds,r=t.FormTemplates,u;n=!n&&t.DataObjects.Data&&t.DataObjects.Data.length>0?t.DataObjects.Data[0]:n;n&&(u=t.SelectedObject,u&&u.InstigatePropertyChangedListeners("SelectedRowClass",!1),r.length===0&&Is.Alive(i)&&i.length>0&&i.forEach(function(n){var t=n.Element(),i={Template:t,Container:t.parentElement};r.Add(i)}),t.selectedObject=n,t.selectedObject.InstigatePropertyChangedListeners("SelectedRowClass",!1),Is.Alive(t.OnSelectedItemChanged)&&t.OnSelectedItemChanged(t.selectedObject),r.forEach(function(n){var i,r;n.Container.Clear();i=n.Template.cloneNode(!0);n.Container.appendChild(i);r=i.Get(function(n){return n.HasDataSet()});t.Bind(t.selectedObject,r)}))},enumerable:!0,configurable:!0}),n.prototype.AddListener=function(n,t){var i=this.eventHandlers.First(function(i){return i.EventType===n&&i.EventHandler===t});i||this.eventHandlers.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eventHandlers.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){n===void 0&&(n=EventType.Any);this.eventHandlers.Remove(function(t){return n===EventType.Any||t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eventHandlers.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n.prototype.More=function(){var e=this,f=HistoryManager.CurrentViewInstance(),n=e.DataObjects.Data,t,i;if(n&&n.length>0){var r=new ViewInstance([],f.ViewContainer),o=n[n.length-1],u=f.Parameters;if(u!=null)for(t=0;t<u.length;t++)(i=u[t],i!==0||this._api.indexOf(i)!==0)&&r.Parameters.Add(i);this.MoreKeys.forEach(function(n){r.Parameters.Add(o[n])});this.loadFromVI(r)}},n}(),DataObject=function(){function n(n,t,i){var r,u,f;t===void 0&&(t=null);i===void 0&&(i=null);this.AlternateOnEvens=!0;this.defaultRowClass=null;this.selectedRowClass=null;this.changeCount=0;this.changeQueued=!1;this.eLstenrs=[];this.oLstenrs=[];this.objectState=ObjectState.Clean;r=n;u=this;u.serverObject=r;u.SubscribeToObjectStateChange=t;i?i.forEach(function(n){Has.Properties(r,n)||(r[n]=null)}):null;u.objectState=ObjectState.Clean;for(f in r)u.setProps(f,r)}return n.prototype.setProps=function(n,t){var i=this,u=function(){return t[n]},f=function(t){i.SetServerProperty(n,t)},r=Object.defineProperty;i[n]===undefined&&(r?r(i,n,{get:u,set:f}):null)},Object.defineProperty(n.prototype,"AlternatingRowClass",{get:function(){var t=this,i=t.alternatingClass!=null?t.alternatingClass:n.DefaultAlternatingRowClass,r,u;return i!=null?(r=t.Container.indexOf(this)+1,u=r%2==0,u===t.AlternateOnEvens?i:null):null},set:function(n){this.alternatingClass=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"DefaultRowClass",{get:function(){return this.AlternatingRowClass?this.AlternatingRowClass:this.defaultRowClass?this.defaultRowClass:n.DefaultRowClass},set:function(n){this.defaultRowClass=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SelectedRowClass",{get:function(){var t=this,i;return Is.Alive(t.Binder)&&t===t.Binder.SelectedObject?(t=this,i=t.selectedRowClass!=null?t.selectedRowClass:n.DefaultSelectedRowClass,i):t.DefaultRowClass},set:function(n){this.selectedRowClass=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ObjectState",{get:function(){return this.objectState},set:function(n){var t=this;t.objectState=n;t.OnObjectStateChanged()},enumerable:!0,configurable:!0}),n.IsDataObject=function(n){return"ObjectState"in n},n.prototype.AddPropertyListener=function(n,t,i){this.eLstenrs.Add(new PropertyListener(n,t,i))},n.prototype.RemovePropertyListeners=function(){this.eLstenrs.Remove(function(){return!0})},n.prototype.OnPropertyChanged=function(n){var t=this,i=this.eLstenrs.Where(function(t){return t.PropertyName===n});i.forEach(function(i){return i.Handler(i.Attribute,t[n])})},n.prototype.AllPropertiesChanged=function(){var n=this;this.eLstenrs.forEach(function(t){return t.Handler(t.Attribute,n[t.PropertyName])})},n.prototype.InstigatePropertyChangedListeners=function(n,t){t===void 0&&(t=!0);this.OnPropertyChanged(n);t&&this.ObjectState!=ObjectState.Cleaning&&(this.ObjectState=ObjectState.Dirty)},n.prototype.AddObjectStateListener=function(n){this.oLstenrs.Add(n)},n.prototype.RemoveObjectStateListener=function(){this.oLstenrs.Remove(function(){return!0})},n.prototype.OnObjectStateChanged=function(){var n=this,t=n.SubscribeToObjectStateChange;t?t.forEach(function(t){return n.InstigatePropertyChangedListeners(t,!1)}):null;n.oLstenrs.forEach(function(t){return t(n)})},n.prototype.OnElementChanged=function(n,t){this[t]=n},Object.defineProperty(n.prototype,"ServerObject",{get:function(){return this.serverObject},set:function(n){this.serverObject=n},enumerable:!0,configurable:!0}),n.prototype.SetServerProperty=function(n,t){var i=this,r=t!=i.ServerObject[n];i.ServerObject[n]=t;r&&i.InstigatePropertyChangedListeners(n,!0)},n.DefaultAlternatingRowClass=null,n.DefaultSelectedRowClass=null,n.DefaultRowClass=null,n}(),StorageType,DataObjectCacheArray,CacheStrategy,Autofill,HistoryContainer,HistoryManager,WindowLoaded,Initializer,Reflection,Is,Has,Navigate,ProgressManager;(function(n){n[n.none=0]="none";n[n.session=1]="session";n[n.local=2]="local"})(StorageType||(StorageType={}));DataObjectCacheArray=function(){function n(n,t,i){var r,e,f,u,o;n===void 0&&(n=null);t===void 0&&(t=null);i===void 0&&(i=null);this.Data=[];r=this;r._cachingKey=n;r._storageState=t;r._newT=i;r._cachingKey&&r._storageState&&r._newT&&(e=r._storageState===StorageType.local?localStorage.getItem:sessionStorage.getItem,f=e(r._cachingKey),Is.NullOrEmpty(f)||(u=JSON.parse(f),Is.Array(u)?(o=u,o.forEach(function(n){r.Add(r._newT(n))})):r.Add(r._newT(u))))}return n.prototype.Add=function(n){this.Data.push(n)},n.prototype.slice=function(n){this.Data.slice(n);this.SaveCache()},n.prototype.indexOf=function(n,t){return this.Data.indexOf(n,t)},n.prototype.SaveCache=function(){var n=this,t=n._cachingKey,i=n._storageState,r;t&&i&&(r=i===StorageType.local?localStorage.setItem:sessionStorage.setItem,r(t,JSON.stringify(n.Data.Select(function(n){return n.ServerObject}))))},n.prototype.forEach=function(n){this.Data.forEach(n)},Object.defineProperty(n.prototype,"length",{get:function(){return this.Data.length},enumerable:!0,configurable:!0}),n.prototype.First=function(n){return this.Data.First(n)},n.prototype.Where=function(n){return this.Data.Where(n)},n}(),function(n){n[n.None=0]="None";n[n.ViewAndPreload=1]="ViewAndPreload";n[n.View=2]="View";n[n.Preload=3]="Preload"}(CacheStrategy||(CacheStrategy={}));var View=function(){function n(n,t,i){n===void 0&&(n=CacheStrategy.View);t===void 0&&(t="content");i===void 0&&(i=null);this.CacheStrategy=CacheStrategy.None;this._containerID=null;this.eHandlrs=[];this.binders=[];this.preload=null;var r=this;r.url=i;r._containerID=t;r.CacheStrategy=n;r.Cache(r.CacheStrategy)}return n.prototype.Prefix=function(){return"/Views/"},n.prototype.Url=function(){if(!this.url){var n=Reflection.GetName(this.constructor).replace("View","");this.url=this.Prefix()+n+".html"}return this.url},n.prototype.ContainerID=function(){return this._containerID},Object.defineProperty(n.prototype,"Preload",{get:function(){return this.preload},set:function(n){this.preload=n},enumerable:!0,configurable:!0}),n.prototype.Cache=function(n){n===void 0&&(n=CacheStrategy.ViewAndPreload);var t=this;t.Preload&&(n===CacheStrategy.ViewAndPreload||n===CacheStrategy.Preload)&&t.Preload.Execute(function(){});(n===CacheStrategy.View||n===CacheStrategy.ViewAndPreload)&&t.postPreloaded(!0)},n.prototype.Show=function(n){var t=this;t.ViewInstance=n;t.binders=[];t.binders.forEach(function(n){return n.RemoveListeners(EventType.Any)});t.Preload?t.Preload.Execute(t.postPreloaded.bind(this)):t.postPreloaded()},n.prototype.postPreloaded=function(n){n===void 0&&(n=!1);var t=this,i=new Ajax;n||i.AddListener(EventType.Completed,t.RequestCompleted.bind(this));i.Get(t.Url())},n.prototype.RequestCompleted=function(n){var t=this;n.Sender.ResponseText&&t.SetHTML(n.Sender.ResponseText);n.Sender=null},n.prototype.SetHTML=function(n){var r=this,t=this,u=t.ContainerID().Element(),i;Is.NullOrEmpty(u)?t.Dispatch(EventType.Completed):(t.cached="div".CreateElement({innerHTML:n}),i=t.cached.Get(function(n){return!Is.NullOrEmpty(n.getAttribute("data-binder"))}),t.countBindersReported=0,i.length>0?(i.forEach(function(n){var i,u;try{i=n.getAttribute("data-binder");i&&(u=new Function("return new "+i+(i.indexOf("Binder(")==0?"":"()")),n.Binder=u(),n.Binder.AddListener(EventType.Completed,t.OnBinderComplete.bind(r)),n.Binder.Element=n,t.binders.Add(n.Binder))}catch(n){window.Exception(n)}}),i.forEach(function(n){if(n.Binder)try{n.Binder.Execute(t.ViewInstance)}catch(i){window.Exception(i)}})):t.MoveStuffFromCacheToReal())},n.prototype.OnBinderComplete=function(n){var i=this,t=this;n.EventType===EventType.Completed&&(t.countBindersReported=t.countBindersReported+1,t.binders.length===t.countBindersReported&&(t.MoveStuffFromCacheToReal(),t.binders.forEach(function(n){n.RemoveListener(EventType.Completed,t.OnBinderComplete.bind(i))})))},n.prototype.MoveStuffFromCacheToReal=function(){var n=this,t=n.ContainerID().Element(),r=t.Get(function(n){return n.Binder!=null}),i;for(r.forEach(function(n){return n.Binder.Dispose()}),t.Clear();n.cached.childNodes.length>0;)i=n.cached.childNodes[0],n.cached.removeChild(i),t.appendChild(i);setTimeout(function(){n.Dispatch(EventType.Completed);n.binders.forEach(function(n){return n.ResetSelectedObject()})},100)},n.prototype.AddListener=function(n,t){var i=this,r=i.eHandlrs.First(function(i){return i.EventType===n&&i.EventHandler===t});r||i.eHandlrs.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eHandlrs.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eHandlrs.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eHandlrs.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t,n))})},n}(),DataLoaders=function(){function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.completedCount=0;this._dataLoaders=t}return n.prototype.Execute=function(n){var i=this,t=this;t._callback=n;t.completedCount=0;t._dataLoaders.forEach(function(n){return n.Execute(t.Completed.bind(i))})},n.prototype.Completed=function(){var n=this;n.completedCount++;n.completedCount===n._dataLoaders.length&&n._callback()},n}(),DataLoader=function(){function n(n,t,i,r){i===void 0&&(i=null);r===void 0&&(r=null);this._parameters=null;var u=this;u._dataCallBack=t;u._dataUrl=n;u._shouldTryLoad=i}return n.prototype.Execute=function(n){var t=this,i;t._completed=n;!t._shouldTryLoad||t._shouldTryLoad()?(i=new Ajax,i.AddListener(EventType.Completed,t._ajaxCompleted.bind(this)),i.Get(t._dataUrl,t._parameters)):t._completed()},n.prototype._ajaxCompleted=function(n){this._dataCallBack(n);this._completed()},n}(),__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ViewContainers=[],ViewContainer=function(){function n(){this.UrlPattern=null;this.UrlReplacePattern=null;this.ContainerLoaded=null;this.Views=[];this.IsDefault=!1;var n=Reflection.GetName(this.constructor);this.Name=n.replace("ViewContainer","");this.Name=this.Name.replace("Container","");ViewContainers.push(this)}return n.prototype.Show=function(n){var i=n.Parameters,t=this;i&&i.length==1&&t.IsDefault&&(n.Parameters=[]);t.NumberViewsShown=0;ProgressManager.Show();t.Views.forEach(function(i){i.AddListener(EventType.Completed,t.ViewLoadCompleted.bind(t));i.Show(n)})},n.prototype.IsUrlPatternMatch=function(n){var t,i;return!Is.NullOrEmpty(n)&&(n=n.lastIndexOf("/")==n.length-1?n.substring(0,n.length-1):n,t=this.UrlPattern?this.UrlPattern():"^"+this.Name,t)?(i=new RegExp(t,"i"),n.match(i)?!0:!1):!1},n.prototype.ViewLoadCompleted=function(n){var t=this,i=t.NumberViewsShown;n.EventType===EventType.Completed&&(t.NumberViewsShown=t.NumberViewsShown+1);t.NumberViewsShown===t.Views.length&&(ProgressManager.Hide(),window.scrollTo(0,0),t.ContainerLoaded!==null&&t.ContainerLoaded(),t.Views.forEach(function(n){t.LoadSubViews(n.ContainerID())}))},n.prototype.LoadSubViews=function(n){var t=n.Element().Get(function(n){return Is.Alive(n.dataset.subview)});t.forEach(function(n){var t=new Ajax(!1);t.AddListener(EventType.Any,function(t){var r=t.Sender.ResponseText,i;n.innerHTML=r;i=n.Get(function(n){return!Is.NullOrEmpty(n.getAttribute("data-binder"))});i.length>0&&(i.forEach(function(n){var t,i;try{t=n.getAttribute("data-binder");t&&(i=new Function("return new "+t+(t.indexOf("Binder(")==0?"":"()")),n.Binder=i(),n.Binder.Element=n)}catch(n){window.Exception(n)}}),i.forEach(function(n){if(n.Binder)try{n.Binder.Refresh()}catch(t){window.Exception(t)}}))});t.Get(n.dataset.subview)})},n.prototype.Url=function(t){var o=this,l=t,r=t.Parameters,s=n.VirtualPath,u="",a,e,i;if(l.Route)u=l.Route;else if(o.UrlReplacePattern!==null){var h=o.UrlReplacePattern().split("/"),c=0,f=[];for(i=0;i<h.length;i++)if(a=h[i],a.indexOf("(?:")==0){if(!r)break;if(c<r.length)f.Add(r[c]);else break;c++}else f.Add(h[i]);for(i=0;i<f.length;i++)f[i]=encodeURIComponent(f[i]);u=f.join("/")}if(Is.NullOrEmpty(u)){if(e=[],r)for(i=0;i<r.length;i++)e.Add(encodeURIComponent(r[i]));u=o.Name+(e.length>0?"/"+e.join("/"):"")}return(!Is.NullOrEmpty(s)&&u.indexOf(s)==-1?s+"/":"")+u},n.prototype.UrlTitle=function(){return this.Name.replace(/\//g," ")},n.prototype.DocumentTitle=function(){return this.UrlTitle()},n.prototype.Parameters=function(n){var t=n;return t=t?t.replace(this.Name,""):t,t=t?t.indexOf("/")===0?t.substring(1):t:t,t?t.split("/"):[]},n}(),SingleViewContainer=function(n){function t(t,i,r){t===void 0&&(t=CacheStrategy.View);i===void 0&&(i="content");r===void 0&&(r=!1);var f=n.call(this)||this,u=f;return u.IsDefault=r,u.Views.push(new View(t,i,"/Views/"+u.Name+".html")),f}return __extends(t,n),t}(ViewContainer),ViewInstance=function(){function n(n,t,i){i===void 0&&(i=null);this.Route=i;this.Parameters=n;this.ViewContainer=t}return n}(),EventType;(function(n){n[n.Any=0]="Any";n[n.Completed=1]="Completed";n[n.Error=2]="Error";n[n.Aborted=3]="Aborted";n[n.Message=4]="Message"})(EventType||(EventType={}));var CustomEventArg=function(){function n(n,t){this.Cancel=!1;this.Sender=n;this.EventType=t}return n}(),Listener=function(){function n(n,t){this.EventType=n;this.EventHandler=t}return n}(),PropertyListener=function(){function n(n,t,i){this.PropertyName=n;this.Attribute=t;this.Handler=i}return n}(),ObjectState;(function(n){n[n.Dirty=0]="Dirty";n[n.Cleaning=1]="Cleaning";n[n.Clean=2]="Clean"})(ObjectState||(ObjectState={})),function(n){function v(n,u){var f=Is.Alive(n.dataset[t]&&(n.dataset[i]||n.dataset[r]))&&n.tagName==="INPUT"&&n.type==="text";return f?y(n,u):null,f}function y(n,t){var i=n;i.onkeypress=null;i.onclick=function(){o(i,0)};i.onkeyup=function(){var n=event.keyCode?event.keyCode:event.which;i.value.length===0&&n===8&&s(i)};i.onkeypress=function(){p(event)};i.value=i.dataset[u]?t[i.dataset[u]]:""}function o(n,t){n!=null&&(n.selectionStart?(n.focus(),n.setSelectionRange(t,n.value.length)):n.focus())}function s(n){var i=n.tagName==="INPUT"&&n.dataset[t]?n:n.parentElement.Input(function(n){return Is.Alive(n.dataset[t])}),y=i[e],p=i.dataset,s=p[l],h=c(i),w=y,o=w.First(function(n){return n[h.DM]===i.value}),r,f,v;Is.Alive(s)&&(r=i.DataObject,r&&(i.value.length===0?r[s]=null:o&&(r[s]=o[h.VM],i.dataset[u]&&(r[i.dataset[u]]=o[h.DM]))));f=i.dataset[a];f&&(f=f+"(obj);",v=new Function("obj",f),v(o))}function c(n){var u={VM:"",DM:""},t=n.dataset;return u.DM=t[r]?t[r]:t[i],u.VM=t[i]?t[i]:t[r],u}function p(n){var w=n.keyCode?n.keyCode:n.which,p=n.char?n.char:n.key,i=n.target,a=c(i),l,v,r,y,u;if(i[f]===!0)return!0;if(l=i.value.length,v=i.dataset[h]?parseInt(i.dataset[h]):3,w===13)s(i);else if(l===v)i[f]=!0,r=i.value+p,i.pv=r,y=new Ajax(!1),y.AddListener(EventType.Any,function(n){var t=n.Sender.GetRequestData();i[e]=t;t&&t.length>0&&(i.value=t[0][a.DM]);o(i,4);i[f]=!1}),u=i.dataset[t],u=u.slice(-1)!=="/"?u+"/":u,y.Get(u+r);else if(l>v+1)return r=i.pv+p,l=r.length,i.pv=r,setTimeout(function(){var t=i[e],n;t&&(n=t.First(function(n){return n[a.DM].toLowerCase().indexOf(r.toLowerCase())>-1}),n&&(i.value=n[a.DM]),o(i,l))},10),!0}var t="autofillapi",l="value",i="valuemember",r="displaymember",a="completed",h="length",f="busy",e="cache",u="objdisplaymember";n.IsAutoFill=v;n.SetValue=s}(Autofill||(Autofill={})),function(n){var t=function(){function n(){this.ViewInstances=[];this.eHandlrs=[]}return n.prototype.CurrentViewInstance=function(){var n=this.ViewInstances;return n!=null&&n.length>0?n[n.length-1]:null},n.prototype.BackEvent=function(){HistoryManager.Back()},n.prototype.Add=function(n){var i=n,t=this;t.ViewInstances.Add(i);t.ManageRouteInfo(i);t.Dispatch(EventType.Completed)},n.prototype.Back=function(){var i=this,n=i.ViewInstances,t,r;n.length>1&&n.splice(n.length-1,1);n.length>0&&(t=n[n.length-1],r=t.ViewContainer,r.Show(t),i.ManageRouteInfo(t),i.Dispatch(EventType.Completed))},n.prototype.ManageRouteInfo=function(n){var i=n,r=i.ViewContainer,f=r.UrlTitle(i),e=r.DocumentTitle(i),u=history,t=r.Url(i);t!==null&&!Is.NullOrEmpty(f)&&u&&u.pushState&&(t=Is.NullOrEmpty(t)?"/":t.indexOf("/")!=0?"/"+t:t,u.pushState(null,f,t));e&&(document.title=e)},n.prototype.Manual=function(n,t,i){i===void 0&&(i=null);document.title=i?i:n;history.pushState(null,n,t)},n.prototype.AddListener=function(n,t){var i=this,r=i.eHandlrs.First(function(i){return i.EventType===n&&i.EventHandler===t});r||i.eHandlrs.Add(new Listener(n,t))},n.prototype.RemoveListener=function(n,t){this.eHandlrs.Remove(function(i){return i.EventType===n&&t===t})},n.prototype.RemoveListeners=function(n){this.eHandlrs.Remove(function(t){return t.EventType===n})},n.prototype.Dispatch=function(n){var t=this,i=this.eHandlrs.Where(function(t){return t.EventType===n});i.forEach(function(i){return i.EventHandler(new CustomEventArg(t.CurrentViewInstance().ViewContainer,n))})},n}();n.History=t}(HistoryContainer||(HistoryContainer={}));HistoryManager=new HistoryContainer.History;WindowLoaded=function(){function n(n,t){this.LoadedEvent=n;this.ShouldRunBeforeNavigation=t;Initializer.WindowLoaded=this}return n}(),function(n){function i(n){document.readyState==="complete"?t(n):window.onload=function(){t(n)}}function t(t){var i=n.WindowLoaded,u=r,f=i.LoadedEvent;i?i.ShouldRunBeforeNavigation?f(t,u):(u(),f(t,null)):u()}function r(){var n=window;u();Navigate.Url(n.location.pathname.substring(1));n.addEventListener("popstate",HistoryManager.BackEvent)}function u(){var n=document.getElementById("progress");n!=null&&(ProgressManager.ProgressElement=n)}n.Execute=i}(Initializer||(Initializer={})),function(n){function t(n,t){var r,u,i;return(t===void 0&&(t=[]),r=n&&n.toString?n.toString():null,!Is.NullOrEmpty(r)&&(u="^function\\s(\\w+)\\(\\)",i=r.match(u),i&&!t.First(function(n){return n===i[1]})))?i[1]:null}function i(n){return new n}n.GetName=t;n.NewObject=i}(Reflection||(Reflection={}));Initializer.Execute(),function(n){function t(n){return Object.prototype.toString.call(n)==="[object Array]"}function i(n){return n===undefined||n===null||typeof n=="string"&&n.length===0}function r(n){return!isNaN(parseFloat(n))&&isFinite(n)}function u(n){return typeof n=="string"}function f(n){return n!==undefined&&n!==null}function e(t){return n.Alive(t.tagName)}n.Array=t;n.NullOrEmpty=i;n.Number=r;n.String=u;n.Alive=f;n.HTMLElement=e}(Is||(Is={})),function(n){function t(n){for(var r,i,u=[],t=1;t<arguments.length;t++)u[t-1]=arguments[t];for(r=u,i=0;i<r.length;i++)if(n[r[i]]===undefined)return!1;return!0}n.Properties=t}(Has||(Has={})),function(n){function t(n,t){var i,r,u;t===void 0&&(t=null);i=Is.Array(t)?t:[];Is.Alive(t)&&!Is.Array(t)&&i.Add(t);i=i&&i.length==1&&i[0]===""?null:i;r=Reflection.NewObject(n);u=new ViewInstance(i,r);r.Show(u);HistoryManager.Add(u)}function i(n){var f=ViewContainer.VirtualPath,u=ViewContainers,i,t,r;if(n=f&&n.length>0?n.replace(f,""):n,n=n.length>0&&n.indexOf("/")===0?n.substr(1):n,i=n.length===0?u.First(function(n){return n.IsDefault}):u.Where(function(n){return!n.IsDefault}).First(function(t){return t.IsUrlPatternMatch(n)}),i=i==null?u.First(function(n){return n.IsDefault}):i,i){for(t=i.Parameters(n),r=new ViewInstance(t,i,n),t=r.Parameters,t&&t.length&&!Is.NullOrEmpty(ViewContainer.VirtualPath)&&t[0]==ViewContainer.VirtualPath&&t.splice(0,1);t.length&&t.length>0&&Is.NullOrEmpty(t[0]);)t.splice(0,1);i.Show(r);HistoryManager.Add(r)}}n.Spa=t;n.Url=i}(Navigate||(Navigate={})),function(n){function t(){var t=n.ProgressElement;t&&(t.style.display="inline")}function i(){var t=n.ProgressElement;t&&(t.style.display="none")}n.ProgressElement=null;n.Show=t;n.Hide=i}(ProgressManager||(ProgressManager={}));Array.prototype.Select=function(n){for(var i=[],r=this,t=0;t<r.length;t++)i.push(n(r[t]));return i};Array.prototype.Add=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(n=r,Is.Array(n)||(n=[n]),i=0;i<n.length;i++)this.push(n[i])};Array.prototype.First=function(n){var i=this,r=i.length,t;if(n){for(t=0;t<r;t++)if(n(i[t]))return i[t]}else if(r>0)return i[0];return null};Array.prototype.Last=function(n){var i=this,r=i.length,t;if(n)for(t=r-1;t>0;){if(n(i[t]))return i[t];t--}return r>0?i[r-1]:null};Array.prototype.Remove=function(n){var i=this,t;if(n)for(t=i.length-1;t>0;)n(i[t])&&i.splice(t,1),t--;return i};Array.prototype.Where=function(n){for(var i,r=[],t=0;t<this.length;t++)i=this[t],n(i)&&r.push(i);return r};Date.prototype.Add=function(n,t,i,r,u,f){n=n?n:0;t=t?t:0;i=i?i:0;r=r?r:0;u=u?u:0;f=f?f:0;var e=this;return new Date(e.getFullYear()+n,e.getMonth()+t,e.getDate()+i,e.getHours()+r,e.getMinutes()+u,e.getSeconds()+f,e.getMilliseconds())};Date.prototype.ToyyyymmddHHMMss=function(){var n=this,t=function(n){return(n<=9?"0":"")+n.toString()},i=t(n.getDate()),r=t(n.getMonth()+1),u=n.getFullYear(),f=t(n.getHours()),e=t(n.getMinutes()),o=t(n.getSeconds());return""+u+"-"+r+"-"+i+" "+f+":"+e+":"+o};HTMLElement.prototype.Input=function(n){n===void 0&&(n=null);var t=this;return n?t.First(function(t){return t.tagName==="INPUT"&&n(t)}):t.First(function(n){return n.tagName==="INPUT"})};HTMLElement.prototype.InsertBeforeChild=function(n,t){var i=this,f=i.Binder,r=i.First(n),u;r&&(i=r.parentElement,u=i.IndexOf(r),Is.Alive(u)&&(i=this,i.InsertBefore(t,u)))};HTMLElement.prototype.InsertBefore=function(n,t){var r=this,i=r.Binder;Is.Alive(i)&&i.InsertBefore(n,t)};HTMLElement.prototype.Append=function(n){var i=this,t=i.Binder;Is.Alive(t)&&t.Append(n)};HTMLElement.prototype.PostAndAppend=function(n){var i=this,t=i.Binder;Is.Alive(t)&&t.PostAndAppend(n)};HTMLElement.prototype.PostAndInsertBeforeChild=function(n,t){var i=this,f=i.Binder,r=i.First(n),u;if(r&&(i=r.parentElement,u=i.IndexOf(r),Is.Alive(u))){i=this;i.PostAndInsertBefore(t,u);return}i=this;i.PostAndAppend(t)};HTMLElement.prototype.PostAndInsertBefore=function(n,t){var r=this,i=r.Binder;Is.Alive(i)&&i.PostAndInsertBefore(n,t)};HTMLElement.prototype.IndexOf=function(n){for(var r=this,i=r.children,t=i.length-1;t>=0;t--)if(n==i[t])return t;return undefined};HTMLElement.prototype.Bind=function(n,t){var i,f,r,u;if(t===void 0&&(t=!1),t&&this.RemoveDataRowElements(),i=this.Binder,i)if(n instanceof ViewInstance)i.Refresh(n);else if(n instanceof Array)for(f=n,r=0;r<f.length;r++)u=f[r],i.Append(u instanceof DataObject?u:new DataObject(u));else n&&i.Append(n instanceof DataObject?n:new DataObject(n))};HTMLElement.prototype.ClearBoundElements=function(){var n=this;n.Get(function(n){return n.getAttribute("data-template")!=null}).forEach(function(n){return n.parentElement.removeChild(n)})};HTMLElement.prototype.SaveDirty=function(){var n=this,t=Is.Alive(n.Binder)?n:n.Ancestor(function(n){return Is.Alive(n.Binder)});t&&t.Binder&&t.Binder.SaveDirty()};HTMLElement.prototype.Save=function(){var t=this,n=t.Ancestor(function(n){return n.Binder!=null});n&&n.Binder&&n.Binder.Save(t.DataObject)};HTMLElement.prototype.Get=function(n,t,i){for(var r,u=i==null?[]:i,e=this.children,f=0;f<e.length;f++)r=e[f],r.nodeType==1&&r.tagName.toLowerCase()!="svg"&&(n(r)&&u.push(r),!t&&r.Get&&r.Get(n,t,u));return u};HTMLElement.prototype.First=function(n){for(var t,u,r=this.children,i=0;i<r.length;i++)if(t=r[i],t.nodeType==1&&t.tagName.toLowerCase()!="svg"&&n(t))return t;for(i=0;i<r.length;i++)if(t=r[i],t.nodeType==1&&t.tagName.toLowerCase()!="svg"&&t.First&&(u=t.First(n),u))return u;return null};HTMLElement.prototype.Clear=function(){for(var n=this,t=n.childNodes;t.length>0;)n.removeChild(t[0])};HTMLElement.prototype.AddListener=function(n,t){this.addEventListener?this.addEventListener(n,t):this.attachEvent(n,t)};HTMLElement.prototype.Set=function(n){var r=this,i=n,t;if(i)for(t in i)t!="cls"&&t!="className"?t.IsStyle()?r.style[t]=i[t]:t==="style"?i.style.cssText&&(r.style.cssText=i.style.cssText):r[t]=i[t]:(r.className=null,r.className=i[t]);return r};HTMLElement.prototype.HasDataSet=function(){var n=this.dataset,t;if(n)for(t in n)return!0;return!1};HTMLElement.prototype.GetDataSetAttributes=function(){var i=[],n=this.dataset,t;if(n)for(t in n)i.Add({Attribute:t,Property:n[t]});return i};HTMLElement.prototype.Delete=function(){var t=this,n=t.Ancestor(function(n){return n.Binder!=null});n&&n.Binder&&n.Binder.Delete(this,null)};HTMLElement.prototype.Ancestor=function(n){for(var t=this.parentElement;!n(t);)t=t.parentElement;return t};HTMLSelectElement.prototype.AddOptions=function(n,t,i,r){var o=this,h=r,u=n,s=function(n,t){var i=new Option(n,t);o.options[o.options.length]=i;h&&t===h&&(i.selected=!0)},f;if(Is.Array(u)){var e=u,c=i,l=t;c&&l?e.forEach(function(n){s(n[c],n[l])}):e.length>1&&typeof e[0]=="string"&&e.forEach(function(n){s(n,n)})}else if(u)for(f in u)u[f]&&{}.toString.call(u[f])==="[object Function]"||s(u[f],u[f]);return o};String.prototype.RemoveSpecialCharacters=function(n){for(var t,e,o=this,i=null,u="",r=Is.Alive(n)?n:"-",f=0;f<o.length;f++)t=o.charAt(f),e=t.match(/\w/),t===r&&i!==r||e&&e.length>0?(u+=t,i=t):t===" "&&i!==r&&(i=r,u+=i);return u};String.prototype.Trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.Element=function(){return document.getElementById(this.toString())};String.prototype.CreateElement=function(n){var t=document.createElement(this),i=n;return i&&t.Set(i),t};String.prototype.CreateElementFromHtml=function(){for(var t="div".CreateElement({innerHTML:this}),n=t.children;n.length>0;)return n[n.length-1]};String.prototype.IsStyle=function(){for(var n in document.body.style)return n.toLowerCase()===this.toLowerCase();return!1};Window.prototype.Exception=function(n){var r=alert,t=n,u,i;if(Is.Array(t)){for(u={},i=0;i<t.length;i++)u["parameter"+i]=t[i];r(JSON.stringify(u))}else t.length>1?r(JSON.stringify(t[0])):r(t.toString())};